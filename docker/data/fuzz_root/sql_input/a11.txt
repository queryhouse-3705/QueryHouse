CREATE TABLE t0 (c0 JSON); INSERT INTO t0 VALUES ('{"v0": "v1", "v2": 22}'), ('{"v2": 30}'), ('{"v0": "v2", "v2": 25}'), ('{"v2": 28}'); SELECT COALESCE(c0 -> '$.v0', 'default_value') AS v0, ROW_NUMBER() OVER (PARTITION BY COALESCE(c0 -> '$.v0', 'default_value') ORDER BY c0 -> '$.v2') AS row_num, RANK() OVER (PARTITION BY COALESCE(c0 -> '$.v0', 'default_value') ORDER BY c0 -> '$.v2') AS rank_value, DENSE_RANK() OVER (PARTITION BY COALESCE(c0 -> '$.v0', 'default_value') ORDER BY c0 -> '$.v2') AS dense_rank_value, LEAD(c0 -> '$.v2') OVER (PARTITION BY COALESCE(c0 -> '$.v0', 'default_value') ORDER BY c0 -> '$.v2') AS lead_value, LAG(c0 -> '$.v2') OVER (PARTITION BY COALESCE(c0 -> '$.v0', 'default_value') ORDER BY c0 -> '$.v2') AS lag_value, FIRST_VALUE(c0 -> '$.v2') OVER (PARTITION BY COALESCE(c0 -> '$.v0', 'default_value') ORDER BY c0 -> '$.v2') AS first_value1, LAST_VALUE(c0 -> '$.v2') OVER (PARTITION BY COALESCE(c0 -> '$.v0', 'default_value') ORDER BY c0 -> '$.v2' ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS last_value2 FROM t0;