CREATE TABLE t0 (c0 INTEGER PRIMARY KEY, c1 TEXT, c2 DOUBLE); INSERT INTO t0 (c0, c1, c2) VALUES (1, 'Alice', 120.5), (2, 'Bob', 150.0), (3, 'Charlie', 110.75), (4, 'Diana', 200.25), (5, 'Eve', 175.50), (6, 'Frank', 165.30); WITH processed_data AS (SELECT c0, c1, CAST(c2 AS INTEGER) AS int_c2, CASE WHEN c2 > 150 THEN 'High' ELSE 'Low' END AS performance_level FROM t0), summary_data AS (SELECT c0, c1, int_c2, performance_level, COUNT(*) OVER (PARTITION BY performance_level ORDER BY c0) AS total_by_level, AVG(int_c2) OVER (PARTITION BY performance_level ORDER BY c1) AS avg_by_level, MAX(int_c2) OVER (PARTITION BY performance_level ORDER BY c0) AS max_by_level FROM processed_data) SELECT c0, c1, int_c2 AS score, performance_level, total_by_level FROM summary_data WHERE performance_level = 'High' ORDER BY total_by_level DESC;