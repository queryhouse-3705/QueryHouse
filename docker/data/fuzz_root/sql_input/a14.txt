CREATE TABLE t0 (c0 JSON); INSERT INTO t0 VALUES ('["v0", "v1", "v2"]'); INSERT INTO t0 VALUES ('["v3", "v4", "v5"]'); INSERT INTO t0 VALUES ('["v6", "v7", "v8", "v9"]'); WITH json_extracted AS (SELECT c0, c0 -> '$[0]' AS first_value1, c0 -> '$[1]' AS second_value, c0 -> '$[2]' AS third_value, c0 -> '$[3]' AS fourth_value FROM t0) SELECT first_value1, second_value, third_value, fourth_value, COUNT(*) OVER (PARTITION BY first_value1 ORDER BY first_value1) AS total_rows, ROW_NUMBER() OVER (PARTITION BY first_value1 ORDER BY first_value1) AS row_num, CASE WHEN third_value IS NULL THEN 'Short List' ELSE 'Full List' END AS list_type FROM json_extracted WHERE first_value1 IS NOT NULL ORDER BY row_num;