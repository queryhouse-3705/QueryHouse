CREATE TABLE t0 (c0 INTEGER, c1 INTEGER, c2 INTEGER); INSERT INTO t0 VALUES (1, 10, 15); INSERT INTO t0 VALUES (2, 20, 25); INSERT INTO t0 VALUES (3, 15, 30); INSERT INTO t0 VALUES (4, 25, 10); INSERT INTO t0 VALUES (5, 30, 50); SELECT c0, c1, c2, COUNT(c2) FILTER(WHERE c2 > 20) OVER (ORDER BY c1 ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS count_filtered_frame FROM t0;