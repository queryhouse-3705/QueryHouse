CREATE TABLE t0 (item VARCHAR(20), category VARCHAR(20), price INTEGER); INSERT INTO t0 VALUES ('itemA', 'category1', 10), ('itemB', 'category2', 20), ('itemC', 'category1', 30), ('itemD', 'category2', 40); WITH cte AS (SELECT item, category, CAST(price AS FLOAT) AS price, ROW_NUMBER() OVER (PARTITION BY category ORDER BY price) AS item_row FROM t0) SELECT item, category, price, item_row, LEAD(CAST(item_row AS FLOAT)) OVER (PARTITION BY category ORDER BY item_row) AS next_row FROM cte;