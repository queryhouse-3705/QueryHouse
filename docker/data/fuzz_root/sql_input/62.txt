CREATE TABLE t0 (c0 INTEGER, c1 INTEGER, c2 INTEGER); INSERT INTO t0 VALUES (1, 10, 100); INSERT INTO t0 VALUES (2, 20, 200); INSERT INTO t0 VALUES (3, 15, 300); INSERT INTO t0 VALUES (4, 25, 400); SELECT c0, c1, c2, COUNT(*) OVER (ORDER BY c1 ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS count_frame FROM t0;