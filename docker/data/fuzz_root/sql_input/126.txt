CREATE TABLE t0 (c0 INTEGER, c1 INTEGER); INSERT INTO t0 (c0, c1) VALUES (10, 1), (20, 4), (5, 2), (15, 3), (25, 5); SELECT c0, c1, SUM(c0) FILTER (WHERE c1 IN (1, 2, 3)) OVER (ORDER BY c0) AS sum_in_filtered FROM t0;