CREATE TABLE t0 (c0 INTEGER, c1 TEXT, c2 INTEGER); INSERT INTO t0 VALUES (1, 'A', 10); INSERT INTO t0 VALUES (2, 'B', NULL); INSERT INTO t0 VALUES (3, 'A', 30); INSERT INTO t0 VALUES (4, 'B', 40); INSERT INTO t0 VALUES (5, 'A', NULL); SELECT c0, c1, c2, COUNT(c2) OVER (PARTITION BY c1) AS non_null_count_per_category FROM t0;