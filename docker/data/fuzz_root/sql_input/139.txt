CREATE TABLE t0 (c0 INTEGER, c1 INTEGER, c2 INTEGER, c3 INTEGER); INSERT INTO t0 (c0, c1, c2, c3) VALUES (-10, 1, 6, 1), (20, -1, 10, 2), (-5, 2, 8, 3), (15, 0, 4, 4), (-25, 3, 12, 5); SELECT c0, c1, c2, c3, SUM(CASE WHEN c1 > 0 THEN ABS(c0) ELSE NULL END) FILTER (WHERE c2 BETWEEN 5 AND 15) OVER (ORDER BY c3) AS sum_case_function_between_filtered FROM t0;