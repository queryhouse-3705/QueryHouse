CREATE TABLE t0 (c0 INTEGER, c1 INTEGER GENERATED ALWAYS AS (c0 * 2) VIRTUAL); INSERT INTO t0 (c0) VALUES (10), (3), (7), (2); SELECT c0, c1, CAST(AVG(c0) FILTER(WHERE c0 > 5) OVER (PARTITION BY c1 ORDER BY c0) AS INTEGER) AS avg_filtered, CAST(SUM(c0) OVER (PARTITION BY c1 ORDER BY c0) AS INTEGER) AS sum_value, ROW_NUMBER() OVER (PARTITION BY c1 ORDER BY c0) AS row_num FROM t0;