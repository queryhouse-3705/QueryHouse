CREATE TABLE t0 (c0 INTEGER, c1 INTEGER, c2 INTEGER, c3 INTEGER); INSERT INTO t0 (c0, c1, c2, c3) VALUES (10, 3, 1, 1), (20, 5, 1, 2), (5, 2, 2, 1), (15, -1, 2, 2), (25, 4, 3, 3); SELECT c0, c1, c2, c3, SUM(c0 + -c1) OVER (PARTITION BY c2 ORDER BY c3 ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS sum_binary_unary_partition_rows FROM t0;