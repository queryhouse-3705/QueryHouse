CREATE TABLE t0 (c0 INTEGER, c1 INTEGER, c2 INTEGER); INSERT INTO t0 (c0, c1, c2) VALUES (10, NULL, 1), (20, 5, -1), (5, NULL, 2), (15, NULL, 3), (25, 4, 0); SELECT c0, c1, c2, SUM(CASE WHEN c1 IS NULL THEN c0 ELSE NULL END) FILTER (WHERE c2 > 0) OVER (ORDER BY c0 ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS sum_case_is_null_rows_filtered FROM t0;