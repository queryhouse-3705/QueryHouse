CREATE TABLE t0 (c0 TEXT, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 (c0, c1, c2) VALUES ('groupX', 1.1, 0.01), ('groupY', 2.2, 0.02), ('groupX', 3.3, 0.03), ('groupZ', 4.4, 0.04); SELECT c0, c1, c2, ROW_NUMBER() OVER (PARTITION BY c0 ORDER BY c1 / c2 DESC, LENGTH(c0)) AS rn FROM t0;