CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (1000, -100.1, 1000.01), (-1000, 200.2, -2000.02), (500, -300.3, 3000.03), (-500, 400.4, -4000.04); SELECT c1, c2, MIN(c1 + c2 - c0) OVER (PARTITION BY SIGN(c1) ORDER BY ABS(c2) DESC ROWS BETWEEN 2 FOLLOWING AND 3 FOLLOWING) AS min_adjusted_combined FROM t0;