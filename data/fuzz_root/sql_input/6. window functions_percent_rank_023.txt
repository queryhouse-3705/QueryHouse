CREATE TABLE t0(c0 INTEGER, c1 FLOAT, c2 DOUBLE, c3 TEXT); INSERT INTO t0(c0, c1, c2, c3) VALUES (1, -5.5, 3.3, 'alpha'), (2, 10.1, -7.2, 'beta'), (3, 8.8, 2.2, 'gamma'), (4, 0.0, 0.0, 'delta'), (5, 15.3, -20.5, 'epsilon'); SELECT c0, c1, c2, c3, PERCENT_RANK() OVER (PARTITION BY c3 LIKE 'a%' ORDER BY SQRT(ABS(c1 * c2)) DESC NULLS FIRST) AS rank_percent FROM t0;