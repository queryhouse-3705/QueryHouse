CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (100, 10.01, -1000.01), (200, -20.02, 2000.02), (-300, 30.03, -3000.03), (-400, -40.04, 4000.04); SELECT MIN(c2 / c1) OVER (PARTITION BY c0 > 0 ORDER BY c1 ASC RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS min_ratio, c1, c0 FROM t0;