CREATE TABLE t0 (c0 INTEGER, c1 DOUBLE, c2 VARCHAR(5), c3 INTEGER); INSERT INTO t0 (c0, c1, c2, c3) VALUES (1, 1000.1, 'a', 100), (2, 2000.2, 'b', 200), (3, 3000.3, 'a', 300), (4, 4000.4, 'c', 400), (5, 5000.5, 'b', 500); SELECT nth_value(c3, 2) OVER (PARTITION BY c2 ORDER BY c1 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS first_two_sum FROM t0;