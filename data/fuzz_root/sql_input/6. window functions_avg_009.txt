CREATE TABLE t0 (c0 VARCHAR(50), c1 FLOAT, c2 INT); INSERT INTO t0 (c0, c1, c2) VALUES ('GroupA', -1.1, 100), ('GroupA', 2.2, 200), ('GroupB', -3.3, 300), ('GroupB', 4.4, 400); SELECT c0, c1, c2, AVG(c1) OVER(PARTITION BY c0 ORDER BY c2) AS avg_dynamic FROM t0;