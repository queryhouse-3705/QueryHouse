CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (1000, 0.001, 1.001), (-1000, -0.002, -2.002), (500, 0.003, 3.003), (-500, -0.004, -4.004); SELECT MIN(c2) OVER (PARTITION BY SIGN(c0) ORDER BY c1 ASC RANGE BETWEEN CURRENT ROW AND 2 FOLLOWING) AS min_sign_partition, c0, c1 FROM t0;