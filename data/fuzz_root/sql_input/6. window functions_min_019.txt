CREATE TABLE t0 (c0 TEXT, c1 VARCHAR(50), c2 FLOAT, c3 DOUBLE, c4 JSON); INSERT INTO t0 VALUES ('v0', 'v1', 0.1, -10.01, '{"key": "value"}'), ('v2', 'v3', -0.2, 20.02, '{"key": 123}'), ('v4', 'v5', 0.3, -30.03, '{"array": [1,2]}'), ('v6', 'v7', -0.4, 40.04, '{"nested": {"key": "value"}}'); SELECT c0, c2, MIN(CASE WHEN LENGTH(c1) > 2 THEN c3 - c2 ELSE c2 * c3 END) OVER (ORDER BY c2 ASC RANGE BETWEEN 1 PRECEDING AND CURRENT ROW) AS min_condition FROM t0;