CREATE TABLE t0 (c0 FLOAT, c1 DOUBLE, c2 TEXT); CREATE TABLE t1 (c0 VARCHAR(20), c1 INTEGER, c2 DOUBLE); INSERT INTO t0 (c0, c1, c2) VALUES (1.23, 123.45, 'v22'), (4.56, 456.78, 'v23'), (7.89, 789.01, 'v24'); INSERT INTO t1 (c0, c1, c2) VALUES ('v25', 10, 1.1), ('v26', 20, 2.2), ('v27', 30, 3.3); SELECT t0.c2, t1.c0, RANK() OVER (PARTITION BY t1.c1 ORDER BY t0.c1 DESC) AS rank_value FROM t0 INNER JOIN t1 ON ROUND(t0.c0) = t1.c1;