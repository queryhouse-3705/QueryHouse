CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (50, -0.5, 0.05), (25, 0.25, -0.025), (-50, -0.75, 0.075), (-25, 0.1, -0.01); SELECT c0, MIN(ABS(c1)) OVER (PARTITION BY c2 < 0 ORDER BY c0 ASC RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS min_abs_partition FROM t0;