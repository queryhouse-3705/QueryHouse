CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (123, 123.123, -1234.123), (456, -456.456, 4567.456), (-789, 789.789, -7890.789), (101, -101.101, 1010.101); SELECT MIN(c2 / c1) OVER (PARTITION BY c0 > 0 ORDER BY c1 DESC RANGE BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS min_ratio_global FROM t0;