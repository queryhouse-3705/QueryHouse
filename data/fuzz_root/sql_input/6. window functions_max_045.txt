CREATE TABLE t0 (c0 INTEGER, c1 FLOAT); INSERT INTO t0 (c0, c1) VALUES (10, 0.001), (20, -0.002), (30, 0.003), (40, -0.004), (50, 0.005); SELECT c0, c1, MAX(c1) OVER (ORDER BY c0 / c1 RANGE BETWEEN 1 PRECEDING AND 2 FOLLOWING) AS max_custom_logic FROM t0;