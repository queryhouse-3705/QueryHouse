CREATE TABLE t0 (c0 INTEGER, c1 TEXT, c2 FLOAT); CREATE TABLE t1 (c0 JSON, c1 DOUBLE, c2 VARCHAR(10)); INSERT INTO t0 (c0, c1, c2) VALUES (1, 'v9', 1.23), (2, 'v10', 4.56), (3, 'v11', 7.89); INSERT INTO t1 (c0, c1, c2) VALUES ('{"key":"value1"}', 123.456, 'v12'), ('{"key":"value2"}', 789.012, 'v13'), ('{"key":"value3"}', 345.678, 'v14'); SELECT t1.c0, t1.c2, t0.c1, RANK() OVER (PARTITION BY LENGTH(t1.c2) ORDER BY t1.c1 ASC) AS rank_value FROM t0 CROSS JOIN t1;