CREATE TABLE t0 (c0 TEXT, c1 INT); INSERT INTO t0 (c0, c1) VALUES ('A', 10), ('A', 20), ('B', 30), ('B', 40); SELECT c0, c1, COUNT(*) OVER (PARTITION BY c0 ORDER BY c1 ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS local_group_count FROM t0;