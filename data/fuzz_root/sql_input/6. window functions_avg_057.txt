CREATE TABLE t0 (c0 VARCHAR(50), c1 FLOAT, c2 VARCHAR(50)); INSERT INTO t0 (c0, c1, c2) VALUES ('A', 10, 'Active'), ('B', 20, 'Inactive'), ('C', 30, 'Active'), ('D', 40, 'Inactive'); SELECT c0, c1, c2, AVG(c1) OVER(PARTITION BY c2) AS avg_state FROM t0;