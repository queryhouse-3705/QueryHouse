CREATE TABLE t0 (c0 INTEGER, c1 FLOAT); INSERT INTO t0 (c0, c1) VALUES (10, 0.0001), (20, 999999.99), (-30, 50.5), (40, -0.00001), (50, 12345.67); SELECT c0, MAX(c1) OVER (PARTITION BY ABS(c0) % 3 ORDER BY c1 ASC) AS max_c1 FROM t0;