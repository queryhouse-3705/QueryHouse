CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(10), c3 DOUBLE); INSERT INTO t0 (c0, c1, c2, c3) VALUES (101, 1111.1, 'setA', -0.11), (202, -2222.2, 'setB', 0.22), (303, 3333.3, 'setA', -0.33), (404, -4444.4, 'setC', 0.44), (505, 5555.5, 'setB', -0.55); SELECT nth_value(c3 / c1, 3) OVER (PARTITION BY c2 ORDER BY c0 ROWS BETWEEN CURRENT ROW AND 1 FOLLOWING) AS ratio FROM t0;