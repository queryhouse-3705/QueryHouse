CREATE TABLE t0 (c0 INT, c1 INT, c2 TEXT); INSERT INTO t0 (c0, c1, c2) VALUES (1, NULL, 'Root'), (2, 1, 'Child1'), (3, 1, 'Child2'), (4, 2, 'Grandchild'); SELECT c0, c1, c2, COUNT(*) OVER (PARTITION BY c1 ORDER BY c0) AS hierarchy_count FROM t0;