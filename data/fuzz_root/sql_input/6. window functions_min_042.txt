CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (1000, 1.001, -10000.001), (-1000, -2.002, 20000.002), (2000, 3.003, -30000.003), (-2000, -4.004, 40000.004); SELECT MIN(c0 / c1) OVER (PARTITION BY c2 > 0 ORDER BY c0 ASC ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS min_normalized_ratio, c0 FROM t0;