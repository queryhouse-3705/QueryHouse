CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (1, 0.1, 1.001), (2, -0.2, -2.002), (3, 0.3, 3.003), (4, -0.4, -4.004); SELECT MIN(c2 / c1) OVER (PARTITION BY c1 > 0 ORDER BY c0 ASC ROWS BETWEEN 1 FOLLOWING AND UNBOUNDED FOLLOWING) AS min_ratio_partition FROM t0;