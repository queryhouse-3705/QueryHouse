CREATE TEMPORARY TABLE t2 (c0 INTEGER, c1 JSON); CREATE TABLE t1 (i0 INTEGER, i1 TEXT); INSERT INTO t2 (c0, c1) VALUES (1, '{"info":[10,20,30]}'), (2, '{"info":[40,50,60]}'); INSERT INTO t1 (i0, i1) VALUES (10, 'data1'), (40, 'data2'); WITH cte_name AS (SELECT c1 -> '$.info[0]' AS info_value FROM t2) SELECT cte_name.info_value, ROW_NUMBER() OVER (ORDER BY cte_name.info_value) FROM cte_name LEFT JOIN t1 ON t1.i0 = 10;