CREATE TABLE t0(c0 INTEGER, c1 FLOAT, c2 TEXT); INSERT INTO t0 VALUES (1, 0.1, 'v0 test'), (2, 0.2, 'v1 test'), (3, 0.3, 'v2 test'), (4, 0.4, 'v3 test'), (5, 0.5, 'v4 test'); SELECT c0, c1, NTILE(3) OVER (PARTITION BY LENGTH(c2) ORDER BY c1 * c0 DESC) AS ntile_rank FROM t0;