CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(5), c3 DOUBLE); INSERT INTO t0 (c0, c1, c2, c3) VALUES (10, 0.99, 'x', -9.87), (20, 1.98, 'y', 10.12), (30, 2.97, 'x', 20.24), (40, 3.96, 'z', 30.36), (50, 4.95, 'y', 40.48); SELECT nth_value(c3 - c1, 2) OVER (PARTITION BY c2 ORDER BY c0 DESC ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS difference_result FROM t0;