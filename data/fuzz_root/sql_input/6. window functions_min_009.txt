CREATE TABLE t0 (c0 TEXT, c1 JSON, c2 INTEGER, c3 FLOAT, c4 DOUBLE, c5 VARCHAR(50)); INSERT INTO t0 VALUES ('v0', '{"key": "value"}', 1, 10.1, -10.01, 'v1'), ('v2', '{"key": 123}', 2, -20.2, 20.02, 'v3'), ('v4', '{"nested": {"key": "v5"}}', 3, 30.3, -30.03, 'v6'), ('v7', '{"array": [1, 2, 3]}', 4, -40.4, 40.04, 'v8'); SELECT c0, c1, c3, MIN(CASE WHEN c2 > 2 THEN c4 ELSE c3 END) OVER (PARTITION BY c5 ORDER BY c0 DESC) AS min_conditional FROM t0;