CREATE TABLE t0 (c0 INTEGER, c1 DOUBLE); INSERT INTO t0 (c0, c1) VALUES (-1, -0.111), (0, 0.0), (1, 0.111), (2, -0.222), (3, 0.333); SELECT c0, c1, MAX(c1) OVER (ORDER BY ABS(c1) DESC ROWS BETWEEN 2 PRECEDING AND 1 FOLLOWING) AS max_abs_ordered_range FROM t0;