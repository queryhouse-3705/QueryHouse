CREATE TABLE t0 (c0 INTEGER, c1 FLOAT); INSERT INTO t0 (c0, c1) VALUES (1, 123.45), (2, -456.78), (3, 789.01), (4, -321.09), (5, 654.32); SELECT c0, c1, LAG(CASE WHEN ABS(c1) > 500 THEN c1 / 2 ELSE c1 * 2 END) OVER (ORDER BY c1 DESC) AS lag_conditional_abs FROM t0;