CREATE TABLE t0 (c0 INT, c1 FLOAT, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (1, 10.5, 1.0), (2, -20.25, 2.0), (3, 30.75, 3.0), (4, -40.5, 4.0); SELECT c0, c1, c2, SUM(c1 * c2) OVER() / SUM(c2) OVER() AS weighted_avg FROM t0;