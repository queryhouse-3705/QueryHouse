CREATE TABLE t0 (c0 VARCHAR(50), c1 FLOAT); INSERT INTO t0 (c0, c1) VALUES ('A', 1.5), ('A', 2.5), ('B', -3.5), ('B', 4.5), ('C', 5.5); SELECT c0, c1, AVG(c1) OVER(PARTITION BY c0 ORDER BY c1 ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS avg_grouped_window FROM t0;