CREATE TABLE t0 (c0 JSON, c1 TEXT, c2 FLOAT, c3 DOUBLE, c4 VARCHAR(50)); INSERT INTO t0 VALUES ('{"key": "v1"}', 'v2', 0.1, -10.01, 'v3'), ('{"key": "v4"}', 'v5', -0.2, 20.02, 'v6'), ('{"nested": {"key": "v7"}}', 'v8', 0.3, -30.03, 'v9'), ('{"array": [1,2,3]}', 'v10', -0.4, 40.04, 'v11'); SELECT c0, c2, MIN(c2 * c3 - LENGTH(c4)) OVER (PARTITION BY c1 ORDER BY c2 DESC RANGE BETWEEN 1 PRECEDING AND 2 FOLLOWING) AS min_advanced FROM t0;