CREATE TABLE t0 (c0 INTEGER, c1 TEXT, c2 JSON, c3 FLOAT, c4 DOUBLE, c5 VARCHAR(50)); INSERT INTO t0 VALUES (1, 'v0', '{"key": "value"}', 10.1, -100.01, 'v1'), (2, 'v2', '{"key": 123}', -20.2, 200.02, 'v3'), (3, 'v4', '{"nested": {"key": "v5"}}', 30.3, -300.03, 'v6'), (4, 'v7', '{"array": [1,2,3]}', -40.4, 400.04, 'v8'); SELECT c0, MIN(c3 + ABS(c4)) OVER (PARTITION BY LENGTH(c5) > 2 ORDER BY c1) AS min_abs_calc FROM t0;