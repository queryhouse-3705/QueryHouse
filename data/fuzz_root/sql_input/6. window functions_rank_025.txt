CREATE TABLE t0 (c0 TEXT, c1 JSON, c2 DOUBLE); CREATE TABLE t1 (c0 FLOAT, c1 VARCHAR(20), c2 INTEGER); INSERT INTO t0 (c0, c1, c2) VALUES ('v13', '{"meta":"data1"}', 12.34), ('v14', '{"meta":"data2"}', 56.78), ('v15', '{"meta":"data3"}', 90.12); INSERT INTO t1 (c0, c1, c2) VALUES (1.23, 'v16', 5), (4.56, 'v17', 15), (7.89, 'v18', 25); SELECT t0.c0, t1.c0, RANK() OVER (PARTITION BY LENGTH(t1.c1) ORDER BY t0.c2) AS rank_value FROM t0 RIGHT JOIN t1 ON t0.c2 = t1.c0 * 10;