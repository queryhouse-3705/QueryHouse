CREATE TABLE t0 (c0 FLOAT, c1 DOUBLE, c2 VARCHAR(20)); CREATE TABLE t1 (c0 INTEGER, c1 TEXT, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (1.23, 123.45, 'v31'), (4.56, 456.78, 'v32'), (7.89, 789.01, 'v33'); INSERT INTO t1 (c0, c1, c2) VALUES (10, 'v34', 1.1), (20, 'v35', 2.2), (30, 'v36', 3.3); SELECT t0.c1, t1.c1, RANK() OVER (PARTITION BY LENGTH(t1.c1) ORDER BY t0.c0 DESC NULLS FIRST) AS rank_value FROM t0 CROSS JOIN t1;