CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (50, 5.5, -50.5), (25, -2.5, 25.25), (-50, 7.5, -75.75), (-25, -0.25, 25.025); SELECT c1, MIN(c0 * c1 + c2) OVER (PARTITION BY c2 > 0 ORDER BY c0 ASC RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS min_weighted_partition FROM t0;