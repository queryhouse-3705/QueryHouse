CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (1, 0.1, 1.001), (2, -0.2, -2.002), (3, 0.3, 3.003), (4, -0.4, -4.004); SELECT c0, MIN(c1 * c2) OVER (PARTITION BY c0 BETWEEN 2 AND 4 ORDER BY c1 DESC ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS min_product_partition FROM t0;