CREATE TABLE t0 (c0 TEXT, c1 INTEGER, c2 DOUBLE); INSERT INTO t0 (c0, c1, c2) VALUES ('a', 1, 0.1), ('b', 2, 0.2), ('c', 3, 0.3), ('d', 4, 0.4); SELECT c0, c1, c2, ROW_NUMBER() OVER (PARTITION BY c1 % 2 ORDER BY c2 DESC, LENGTH(c0)) AS rn FROM t0;