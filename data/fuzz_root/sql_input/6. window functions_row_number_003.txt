CREATE TABLE t0 (c0 INTEGER, c1 INTEGER, c2 INTEGER); INSERT INTO t0 (c0, c1, c2) VALUES (1, 2, 3), (4, 5, 6), (7, 8, 9), (10, 11, 12); SELECT c0, c1, c2, ROW_NUMBER() OVER (PARTITION BY c0 + c1 ORDER BY c2 DESC) AS rn FROM t0;