CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 TEXT, c3 DOUBLE); INSERT INTO t0 (c0, c1, c2, c3) VALUES (100, 1.1, 'grp1', 0.1), (200, 2.2, 'grp2', 0.2), (300, 3.3, 'grp1', 0.3), (400, 4.4, 'grp2', 0.4); SELECT c0, c1, c2, c3, ROW_NUMBER() OVER (PARTITION BY c2 ORDER BY c1 / c3 ASC) AS rn FROM t0;