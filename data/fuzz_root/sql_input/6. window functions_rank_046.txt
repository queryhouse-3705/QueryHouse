CREATE TABLE t0 (c0 FLOAT, c1 DOUBLE, c2 TEXT); CREATE TABLE t1 (c0 INTEGER, c1 VARCHAR(20), c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (12.34, 123.45, 'v31'), (56.78, 456.78, 'v32'), (90.12, 789.01, 'v33'); INSERT INTO t1 (c0, c1, c2) VALUES (10, 'v34', 1.1), (20, 'v35', 2.2), (30, 'v36', 3.3); SELECT t0.c2, t1.c1, RANK() OVER (PARTITION BY t1.c2 ORDER BY t0.c1 DESC NULLS LAST) AS rank_value FROM t0 CROSS JOIN t1;