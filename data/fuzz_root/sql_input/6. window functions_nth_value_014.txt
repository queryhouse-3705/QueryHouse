CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(5)); INSERT INTO t0 (c0, c1, c2) VALUES (5, 0.99, 'cat'), (4, -1.01, 'dog'), (3, 3.03, 'cat'), (2, -4.04, 'fish'), (1, 5.05, 'dog'); SELECT c2, nth_value(c1, 1) OVER (PARTITION BY c2 ORDER BY c0 ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) * nth_value(c1, 2) OVER (PARTITION BY c2 ORDER BY c0 DESC) AS interaction FROM t0;