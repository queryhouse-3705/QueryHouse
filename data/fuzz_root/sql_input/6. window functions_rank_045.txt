CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(20)); CREATE TABLE t1 (c0 DOUBLE, c1 TEXT, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (10, 1.23, 'v25'), (20, 4.56, 'v26'), (30, 7.89, 'v27'); INSERT INTO t1 (c0, c1, c2) VALUES (123.45, 'v28', 12.34), (456.78, 'v29', 56.78), (789.01, 'v30', 90.12); SELECT t1.c1, t0.c2, RANK() OVER (PARTITION BY MOD(t0.c0, 2) ORDER BY t1.c2 ASC NULLS FIRST) AS rank_value FROM t0 INNER JOIN t1 ON t0.c0 = t1.c0;