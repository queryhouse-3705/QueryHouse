CREATE TABLE t0 (c0 INTEGER, c1 DOUBLE, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (1, 1000.123, 0.1), (2, -2000.456, 0.2), (3, 3000.789, 0.3), (4, -4000.012, 0.4), (5, 5000.345, 0.5); SELECT nth_value(c1 / c2, 4) OVER (ORDER BY c1 DESC ROWS BETWEEN CURRENT ROW AND 3 FOLLOWING) AS division_result FROM t0;