CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (1000, 100.01, -1000.01), (-1000, -200.02, 2000.02), (500, 300.03, -3000.03), (-500, -400.04, 4000.04); SELECT c0, MIN(c1 + c2 * c0 / ABS(c1)) OVER (PARTITION BY SIGN(c1) ORDER BY c2 DESC ROWS BETWEEN 2 FOLLOWING AND 4 FOLLOWING) AS min_adjusted_partition FROM t0;