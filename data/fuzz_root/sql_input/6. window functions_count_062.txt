CREATE TABLE t0 (c0 INT, c1 VARCHAR(50), c2 INT); INSERT INTO t0 (c0, c1, c2) VALUES (1, 'GroupA', 10), (2, 'GroupA', 20), (3, 'GroupB', 10), (4, 'GroupC', 30); SELECT c1, COUNT(*) OVER (PARTITION BY c1 ORDER BY c2) AS group_count, COUNT(*) OVER (PARTITION BY c2 > 20) AS range_count FROM t0;