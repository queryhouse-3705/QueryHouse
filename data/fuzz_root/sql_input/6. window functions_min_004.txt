CREATE TABLE t0 (c0 INTEGER, c1 JSON, c2 TEXT, c3 FLOAT, c4 DOUBLE, c5 VARCHAR(50)); INSERT INTO t0 VALUES (10, '{"a":1}', 'v0', 1.1, -10.01, 'v1'), (20, '{"b":2}', 'v2', -2.2, 20.02, 'v3'), (30, '{"c":3}', 'v4', 3.3, -30.03, 'v5'), (40, '{"d":4}', 'v6', -4.4, 40.04, 'v7'); SELECT c1, c2, c3, MIN(CASE WHEN c4 < 0 THEN ABS(c4) ELSE c3 * c4 END) OVER (ORDER BY c0 ASC RANGE BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS min_calc FROM t0;