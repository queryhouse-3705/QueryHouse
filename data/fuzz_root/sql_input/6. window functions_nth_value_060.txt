CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(5), c3 DOUBLE); INSERT INTO t0 (c0, c1, c2, c3) VALUES (11, -1.5, 'alpha', 10.0), (22, 2.6, 'beta', -20.0), (33, -3.7, 'alpha', 30.0), (44, 4.8, 'gamma', -40.0), (55, -5.9, 'beta', 50.0); SELECT nth_value(c3 / c1, 3) OVER (PARTITION BY c2 ORDER BY c0 RANGE BETWEEN 1 FOLLOWING AND UNBOUNDED FOLLOWING) AS ratio_value FROM t0;