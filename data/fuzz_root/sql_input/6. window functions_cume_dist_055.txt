CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(10)); INSERT INTO t0 (c0, c1, c2) VALUES (1, -1000000.0, 'A'), (2, 0.00000001, 'A'), (3, -999.9999, 'B'), (4, 3.14159, 'C'), (5, -2.71828, 'C'); SELECT c0, c1, c2, CUME_DIST() OVER (PARTITION BY LENGTH(c2) ORDER BY c1 DESC) AS dist FROM t0;