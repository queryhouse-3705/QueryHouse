CREATE TABLE t0(c0 INTEGER, c1 DOUBLE, c2 TEXT, c3 FLOAT); INSERT INTO t0(c0, c1, c2, c3) VALUES (1, 100.1, 'x', 0.01), (2, -50.5, 'y', 1.02), (3, 0.0, 'z', -0.03), (4, 200.2, 'x', 10.5), (5, -150.9, 'y', 5.5); SELECT c0, c1, c2, c3, PERCENT_RANK() OVER (PARTITION BY c2 ORDER BY c1 + c3 * c0 DESC NULLS FIRST) AS rank_percent FROM t0;