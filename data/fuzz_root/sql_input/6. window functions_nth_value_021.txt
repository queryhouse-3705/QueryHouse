CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(5), c3 DOUBLE); INSERT INTO t0 (c0, c1, c2, c3) VALUES (10, 1.23, 'a', 100.5), (20, 2.34, 'b', 200.6), (30, 3.45, 'a', 300.7), (40, 4.56, 'c', 400.8), (50, 5.67, 'b', 500.9); SELECT nth_value(c1 + c3, 1) OVER (PARTITION BY c2 ORDER BY c0 DESC ROWS BETWEEN UNBOUNDED PRECEDING AND 2 FOLLOWING) AS weighted_sum FROM t0;