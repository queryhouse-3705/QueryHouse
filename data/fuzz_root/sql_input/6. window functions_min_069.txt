CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (10, 0.5, -5.5), (-10, -0.6, 6.6), (20, 0.7, -7.7), (-20, -0.8, 8.8); SELECT c1, c2, MIN(c0 + c1 * c2) OVER (PARTITION BY c2 > 0 ORDER BY ABS(c0) ASC ROWS BETWEEN UNBOUNDED PRECEDING AND UNBOUNDED FOLLOWING) AS min_complex_partition FROM t0;