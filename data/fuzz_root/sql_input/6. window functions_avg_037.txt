CREATE TABLE t0 (c0 VARCHAR(50), c1 INT, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES ('GroupA', 1, 100.1), ('GroupA', 2, -200.2), ('GroupB', 1, 300.3), ('GroupB', 2, -400.4); SELECT c0, c1, c2, AVG(c2) OVER(PARTITION BY c0 ORDER BY c1 ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS avg_moving FROM t0;