CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (1, -0.01, 0.001), (2, 0.02, -0.002), (3, -0.03, 0.003), (4, 0.04, -0.004); SELECT MIN(c0 - c2) OVER (PARTITION BY ABS(c1) > 0.02 ORDER BY c1 DESC RANGE BETWEEN CURRENT ROW AND 3 FOLLOWING) AS min_delta_partition FROM t0;