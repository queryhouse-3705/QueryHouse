CREATE TABLE t0 (c0 INT, c1 VARCHAR(50), c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (1, 'SetA', 50), (2, 'SetA', 100), (3, 'SetB', 200), (4, 'SetB', 400); SELECT c0, c1, c2, AVG(c2) OVER(PARTITION BY c1 ORDER BY c0 ROWS BETWEEN 2 PRECEDING AND 1 FOLLOWING) AS avg_partition_window FROM t0;