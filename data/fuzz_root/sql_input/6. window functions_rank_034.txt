CREATE TABLE t0 (c0 FLOAT, c1 INTEGER, c2 VARCHAR(20)); CREATE TABLE t1 (c0 DOUBLE, c1 TEXT, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (12.34, 10, 'v13'), (56.78, 20, 'v14'), (90.12, 30, 'v15'); INSERT INTO t1 (c0, c1, c2) VALUES (123.45, 'v16', 1.1), (456.78, 'v17', 2.2), (789.01, 'v18', 3.3); SELECT t0.c2, t1.c1, RANK() OVER (PARTITION BY t1.c2 ORDER BY t0.c0 NULLS LAST) AS rank_value FROM t0 LEFT JOIN t1 ON t0.c1 = t1.c2 * 10;