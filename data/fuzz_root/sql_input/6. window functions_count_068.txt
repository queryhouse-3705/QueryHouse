CREATE TABLE t0 (c0 INT, c1 VARCHAR(50), c2 INT); INSERT INTO t0 (c0, c1, c2) VALUES (1, 'Alpha', 10), (2, 'Beta', 20), (3, 'Gamma', 10), (4, 'Alpha', 30); SELECT c1, c2, COUNT(*) OVER (PARTITION BY c1, c2 > 15 ORDER BY c0) AS group_count, (SELECT COUNT(DISTINCT c1) FROM t0 WHERE c2 > 10) AS distinct_count FROM t0;