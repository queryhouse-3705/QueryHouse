CREATE TABLE t0(c0 INTEGER, c1 DOUBLE, c2 TEXT, c3 FLOAT, c4 INTEGER); INSERT INTO t0(c0, c1, c2, c3, c4) VALUES (1, 1.618, 'phi', 2.718, 10), (2, -2.718, 'e', -3.141, 20), (3, 3.141, 'pi', 1.618, 30), (4, -1.414, 'sqrt', -0.577, 40), (5, 0.577, 'log', 3.141, 10); SELECT c0, c1, c2, c3, c4, PERCENT_RANK() OVER (PARTITION BY LENGTH(c2) ORDER BY ABS(c1 * c3 / NULLIF(c4, 0)) DESC) AS rank_percent FROM t0;