CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (1, -1.01, 10.001), (2, 2.02, -20.002), (3, -3.03, 30.003), (4, 4.04, -40.004); SELECT c1, c2, MIN(c0 + c1 / c2) OVER (PARTITION BY c1 < 0 ORDER BY ABS(c2) DESC ROWS BETWEEN 2 PRECEDING AND 1 FOLLOWING) AS min_dynamic_ratio FROM t0;