CREATE TABLE t0 (c0 VARCHAR(20), c1 FLOAT, c2 JSON); CREATE TABLE t1 (c0 INTEGER, c1 TEXT, c2 DOUBLE); INSERT INTO t0 (c0, c1, c2) VALUES ('v31', 12.34, '{"z":"value1"}'), ('v32', 45.67, '{"z":"value2"}'), ('v33', 89.01, '{"z":"value3"}'); INSERT INTO t1 (c0, c1, c2) VALUES (10, 'v34', 23.45), (20, 'v35', 67.89), (30, 'v36', 12.34); SELECT t0.c0, t1.c1, RANK() OVER (PARTITION BY t1.c2 ORDER BY t0.c1 DESC) AS rank_value FROM t0 CROSS JOIN t1;