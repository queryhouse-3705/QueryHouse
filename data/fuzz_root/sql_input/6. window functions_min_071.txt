CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (10, -1.01, 100.001), (20, 2.02, -200.002), (-30, -3.03, 300.003), (-40, 4.04, -400.004); SELECT c0, c1, MIN(c2 - c1 * c0) OVER (PARTITION BY ABS(c0) > 20 ORDER BY c2 ASC RANGE BETWEEN CURRENT ROW AND 3 FOLLOWING) AS min_transformed_delta FROM t0;