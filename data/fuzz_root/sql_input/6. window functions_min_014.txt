CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (1, 1.1, 1.11), (2, 2.2, 2.22), (3, 3.3, 3.33), (4, 4.4, 4.44); SELECT c0, MIN(c1 / NULLIF(c2, 0)) OVER (PARTITION BY c2 < 3 ORDER BY c0 DESC) AS min_ratio, c2 FROM t0;