CREATE TABLE t0 (c0 DOUBLE, c1 VARCHAR(20), c2 FLOAT); CREATE TABLE t1 (c0 TEXT, c1 JSON, c2 INTEGER); INSERT INTO t0 (c0, c1, c2) VALUES (1.11, 'v27', 2.22), (3.33, 'v28', 4.44), (5.55, 'v29', 6.66); INSERT INTO t1 (c0, c1, c2) VALUES ('v30', '{"attr":10}', 10), ('v31', '{"attr":20}', 20), ('v32', '{"attr":30}', 30); SELECT t0.c0, t1.c0, RANK() OVER (PARTITION BY t1.c2 ORDER BY t0.c0 DESC, t0.c2 ASC) AS rank_value FROM t0 INNER JOIN t1 ON t0.c2 = t1.c2 / 2;