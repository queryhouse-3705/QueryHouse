CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (10, 100.1, -1000.1), (-10, -200.2, 2000.2), (20, 300.3, -3000.3), (-20, -400.4, 4000.4); SELECT c0, c1, MIN(c0 * c1 - c2) OVER (PARTITION BY ABS(c2) > 1000 ORDER BY c1 DESC RANGE BETWEEN 1 FOLLOWING AND 2 FOLLOWING) AS min_calculated FROM t0;