CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(5), c3 INTEGER); INSERT INTO t0 (c0, c1, c2, c3) VALUES (100, 0.01, 'X', 1), (200, -0.02, 'Y', 2), (300, 0.03, 'Z', 3), (400, -0.04, 'X', 4), (500, 0.05, 'Y', 5); SELECT c2, nth_value(c3, 2) OVER (PARTITION BY c2 ORDER BY c0 DESC RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS latest_id FROM t0;