CREATE TABLE t0 (c0 INTEGER, c1 VARCHAR(20), c2 DOUBLE); CREATE TABLE t1 (c0 FLOAT, c1 TEXT, c2 JSON); INSERT INTO t0 (c0, c1, c2) VALUES (1, 'v0', 100.1), (2, 'v1', 200.2), (3, 'v2', 300.3); INSERT INTO t1 (c0, c1, c2) VALUES (0.1, 'v3', '{"key":"value"}'), (0.2, 'v4', '{"key":"value2"}'), (0.3, 'v5', '{"key":"value3"}'); SELECT t0.c0, t0.c1, t1.c1, RANK() OVER (PARTITION BY t1.c1 ORDER BY t0.c2 NULLS FIRST) AS rank_value FROM t0 RIGHT JOIN t1 ON t0.c0 = t1.c0 * 10;