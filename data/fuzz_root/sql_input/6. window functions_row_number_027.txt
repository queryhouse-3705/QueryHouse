CREATE TABLE t0 (c0 TEXT, c1 INTEGER, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES ('v0', 10, 1.5), ('v1', 20, 2.5), ('v2', 30, 3.5), ('v3', 10, 4.5); SELECT c0, c1, c2, ROW_NUMBER() OVER (PARTITION BY c1 % 10 ORDER BY c2 ASC, LENGTH(c0)) AS rn FROM t0;