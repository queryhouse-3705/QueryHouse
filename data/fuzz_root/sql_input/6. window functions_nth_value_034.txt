CREATE TABLE t0 (c0 INTEGER, c1 DOUBLE, c2 FLOAT, c3 VARCHAR(5)); INSERT INTO t0 (c0, c1, c2, c3) VALUES (101, 1000.1, -1.1, 'A'), (202, -2000.2, 2.2, 'B'), (303, 3000.3, -3.3, 'A'), (404, -4000.4, 4.4, 'C'), (505, 5000.5, -5.5, 'B'); SELECT nth_value(c1 * c2, 3) OVER (PARTITION BY c3 ORDER BY c0 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS total_product FROM t0 WHERE c2 < 0.0;