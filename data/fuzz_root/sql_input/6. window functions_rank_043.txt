CREATE TABLE t0 (c0 FLOAT, c1 VARCHAR(20), c2 DOUBLE); CREATE TABLE t1 (c0 DOUBLE, c1 FLOAT, c2 TEXT); INSERT INTO t0 (c0, c1, c2) VALUES (1.23, 'v13', 123.45), (4.56, 'v14', 456.78), (7.89, 'v15', 789.01); INSERT INTO t1 (c0, c1, c2) VALUES (123.45, 1.1, 'v16'), (456.78, 2.2, 'v17'), (789.01, 3.3, 'v18'); SELECT t1.c0, t1.c2, RANK() OVER (PARTITION BY t1.c1 ORDER BY t0.c0 DESC NULLS FIRST) AS rank_value FROM t0 LEFT JOIN t1 ON t0.c2 = t1.c0;