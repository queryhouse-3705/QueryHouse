CREATE TABLE t0 (c0 INTEGER, c1 VARCHAR(20)); INSERT INTO t0 (c0, c1) VALUES (1, 'first'), (2, 'second'), (3, 'third'), (4, 'fourth'), (5, 'fifth'); SELECT c0, c1, MAX(LENGTH(c1)) OVER (PARTITION BY MOD(c0, 2) ORDER BY LENGTH(c1) DESC RANGE BETWEEN CURRENT ROW AND 2 FOLLOWING) AS max_varchar_length FROM t0;