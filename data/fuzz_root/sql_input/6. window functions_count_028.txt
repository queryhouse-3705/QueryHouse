CREATE TABLE t0 (c0 TEXT, c1 FLOAT, c2 INT); INSERT INTO t0 (c0, c1, c2) VALUES ('A', 1.123, 10), ('B', -1.234, 20), ('A', 2.345, -10), ('C', 0.001, 30); SELECT c0, c2, COUNT(*) OVER (PARTITION BY c1 > 0 ORDER BY c2 ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS mixed_type_count FROM t0;