CREATE TABLE t0(c0 INTEGER, c1 FLOAT, c2 INTEGER); INSERT INTO t0(c0, c1, c2) VALUES (1, 1.5, 10), (2, 2.0, 20), (3, 2.5, 30), (4, 1.5, 40), (5, 3.0, 50); SELECT c0, c1, c2, PERCENT_RANK() OVER (PARTITION BY c2 / 10 ORDER BY FLOOR(c1) + CEIL(c0 * 0.1)) AS rank_percent FROM t0;