CREATE TABLE t0 (c0 TEXT, c1 FLOAT); INSERT INTO t0 (c0, c1) VALUES ('str1', 0.001), ('str2', -0.002), ('str3', 0.003), ('str4', -0.004), ('str5', 0.005); SELECT c0, c1, MAX(c1) OVER (PARTITION BY SUBSTR(c0, 4, 1) ORDER BY ABS(c1) ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS max_substr_abs FROM t0;