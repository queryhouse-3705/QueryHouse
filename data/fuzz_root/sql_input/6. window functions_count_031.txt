CREATE TABLE t0 (c0 INT, c1 TEXT); INSERT INTO t0 (c0, c1) VALUES (1, 'A'), (2, 'B'), (3, 'C'), (4, 'D'); SELECT c1, COUNT(*) OVER (PARTITION BY c1 IN (SELECT c1 FROM t0 WHERE c0 < 3)) AS dynamic_partition_count FROM t0;