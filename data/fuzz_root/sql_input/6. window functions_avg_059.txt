CREATE TABLE t0 (c0 VARCHAR(50), c1 FLOAT); INSERT INTO t0 (c0, c1) VALUES ('GroupA', 100), ('GroupA', 200), ('GroupA', 50), ('GroupB', 400), ('GroupB', 300), ('GroupB', 100); SELECT c0, AVG(c1) OVER(PARTITION BY c0 ORDER BY c1 DESC ROWS BETWEEN UNBOUNDED PRECEDING AND 1 FOLLOWING) AS avg_top_two FROM t0;