CREATE TABLE t0 (c0 INT, c1 TEXT, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (1, 'Group1', 0.1), (2, 'Group2', -0.2), (3, 'Group1', 1.5), (4, 'Group3', -1.5); SELECT c1, COUNT(*) OVER (PARTITION BY c1 ORDER BY c2 ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS window_count FROM t0;