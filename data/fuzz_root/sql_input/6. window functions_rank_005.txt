CREATE TABLE t0 (c0 INTEGER, c1 VARCHAR(10), c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (100, 'v1', 1000.1), (200, 'v2', 2000.2), (300, 'v1', NULL), (400, 'v2', 1000.1), (500, 'v1', 500.5); SELECT c0, c1, c2, RANK() OVER (PARTITION BY c1 ORDER BY c2 NULLS FIRST) AS rank_value FROM t0;