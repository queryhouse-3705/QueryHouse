CREATE TABLE t0 (c0 INTEGER, c1 DOUBLE, c2 FLOAT, c3 VARCHAR(5)); INSERT INTO t0 (c0, c1, c2, c3) VALUES (1, 1000.1, 0.1, 'A'), (2, 2000.2, 0.2, 'B'), (3, 3000.3, 0.3, 'A'), (4, 4000.4, 0.4, 'C'), (5, 5000.5, 0.5, 'B'); SELECT nth_value(c1 * c2, 3) OVER (PARTITION BY c3 ORDER BY c0 RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS product FROM t0;