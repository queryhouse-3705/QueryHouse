CREATE TABLE t0 (c0 INT, c1 FLOAT); INSERT INTO t0 (c0, c1) VALUES (1, 10), (2, 20), (3, 30), (4, 40); SELECT c0, c1, AVG(c1) OVER(PARTITION BY (SELECT MAX(c0) FROM t0 WHERE c0 < 3)) AS avg_dynamic_partition FROM t0;