CREATE TABLE t0 (c0 TEXT, c1 INTEGER, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES ('x', 1, 1.11), ('y', 2, 2.22), ('z', 3, 3.33), ('x', 4, 4.44); SELECT c0, c1, c2, ROW_NUMBER() OVER (PARTITION BY c1 % 2 ORDER BY c2 * c1 ASC, c0 DESC) AS rn FROM t0;