CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (10, 10.01, -10.001), (20, -20.02, 20.002), (-30, 30.03, -30.003), (-40, -40.04, 40.004); SELECT MIN(ABS(c2)) OVER (PARTITION BY c0 % 2 = 0 ORDER BY c1 RANGE BETWEEN 1 FOLLOWING AND 2 FOLLOWING) AS min_abs_partitioned, c0 FROM t0;