CREATE TABLE t0 (c0 INT, c1 INT); INSERT INTO t0 (c0, c1) VALUES (100, 10), (-200, -10), (300, 20), (-400, -20); SELECT c0, c1, COUNT(*) OVER (ORDER BY c0 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS change_count FROM t0 WHERE c1 > 0;