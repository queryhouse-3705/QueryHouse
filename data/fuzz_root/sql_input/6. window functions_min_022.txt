CREATE TABLE t0 (c0 DOUBLE, c1 VARCHAR(50), c2 JSON, c3 TEXT, c4 FLOAT); INSERT INTO t0 VALUES (-100.1, 'v1', '{"key": "value"}', 'v2', 10.5), (200.2, 'v3', '{"key": 123}', 'v4', -20.5), (-300.3, 'v5', '{"array": [1,2]}', 'v6', 30.0), (400.4, 'v7', '{"nested": {"key3": "value"}}', 'v8', -40.0); SELECT c0, MIN(c4 + LENGTH(c3)) OVER (PARTITION BY c1 ORDER BY c4 RANGE BETWEEN 1 PRECEDING AND 2 FOLLOWING) AS min_text_calc FROM t0;