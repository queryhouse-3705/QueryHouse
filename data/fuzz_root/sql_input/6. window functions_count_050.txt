CREATE TABLE t0 (c0 TEXT, c1 FLOAT, c2 INT); INSERT INTO t0 (c0, c1, c2) VALUES ('Alpha', 1.123, 10), ('Beta', -2.345, -20), ('Gamma', 3.456, 0), ('Delta', -4.567, 30); SELECT c0, c1, COUNT(*) OVER (PARTITION BY c1 > 0 ORDER BY c2 ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS type_partition_count FROM t0;