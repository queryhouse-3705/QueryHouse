CREATE TABLE t0(c0 INTEGER, c1 FLOAT); INSERT INTO t0(c0, c1) VALUES (1, -10.5), (2, 20.1), (3, -15.7), (4, 20.1), (5, -5.9); SELECT c0, c1, PERCENT_RANK() OVER (PARTITION BY c1 > 0 ORDER BY ABS(c1) DESC) AS rank_percent FROM t0;