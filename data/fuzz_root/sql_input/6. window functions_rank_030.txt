CREATE TABLE t0 (c0 JSON, c1 VARCHAR(10), c2 DOUBLE); CREATE TABLE t1 (c0 FLOAT, c1 TEXT, c2 INTEGER); INSERT INTO t0 (c0, c1, c2) VALUES ('{"attr":"v0"}', 'v1', 12.34), ('{"attr":"v2"}', 'v3', 56.78), ('{"attr":"v4"}', 'v5', 90.12); INSERT INTO t1 (c0, c1, c2) VALUES (1.23, 'v6', 10), (4.56, 'v7', 20), (7.89, 'v8', 30); SELECT t0.c0, t1.c1, t1.c2, RANK() OVER (PARTITION BY t1.c2 ORDER BY t0.c2 NULLS LAST) AS rank_value FROM t0 LEFT JOIN t1 ON t0.c2 = t1.c0;