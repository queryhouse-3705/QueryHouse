CREATE TABLE t0 (c0 FLOAT, c1 DOUBLE, c2 VARCHAR(20)); CREATE TABLE t1 (c0 DOUBLE, c1 FLOAT, c2 TEXT); INSERT INTO t0 (c0, c1, c2) VALUES (1.23, 123.45, 'v31'), (4.56, 456.78, 'v32'), (7.89, 789.01, 'v33'); INSERT INTO t1 (c0, c1, c2) VALUES (123.45, 1.23, 'v34'), (456.78, 4.56, 'v35'), (789.01, 7.89, 'v36'); SELECT t0.c2, t1.c2, RANK() OVER (PARTITION BY ROUND(t1.c1) ORDER BY t0.c0 ASC NULLS FIRST) AS rank_value FROM t0 INNER JOIN t1 ON t0.c1 = t1.c0;