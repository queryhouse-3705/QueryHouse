CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (500, 50.5, -500.05), (250, -25.6, 250.06), (-750, 75.7, -750.07), (-250, -25.8, 250.08); SELECT c1, MIN(c2 - c1) OVER (PARTITION BY SIGN(c0) ORDER BY c0 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS min_delta_partitioned FROM t0;