CREATE TABLE t0 (c0 FLOAT); INSERT INTO t0 (c0) VALUES (0.1), (-0.1), (1000000), (-1000000), (0.00001); SELECT c0, AVG(c0) OVER(ORDER BY c0 ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS avg_moving FROM t0;