CREATE TABLE t0 (c0 DOUBLE, c1 FLOAT, c2 VARCHAR(20)); CREATE TABLE t1 (c0 VARCHAR(20), c1 DOUBLE, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (123.45, 1.23, 'v7'), (456.78, 4.56, 'v8'), (789.01, 7.89, 'v9'); INSERT INTO t1 (c0, c1, c2) VALUES ('v10', 123.45, 1.1), ('v11', 456.78, 2.2), ('v12', 789.01, 3.3); SELECT t0.c2, t1.c0, RANK() OVER (PARTITION BY t1.c1 ORDER BY t0.c1 DESC NULLS LAST) AS rank_value FROM t0 LEFT JOIN t1 ON t0.c0 = t1.c1;