CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(10)); INSERT INTO t0 (c0, c1, c2) VALUES (10, -123.45, 'team1'), (20, 234.56, 'team2'), (30, -345.67, 'team1'), (40, 456.78, 'team3'), (50, -567.89, 'team2'); SELECT nth_value(c1, 2) OVER (PARTITION BY c2 ORDER BY c0 DESC ROWS BETWEEN 1 FOLLOWING AND 2 FOLLOWING) + nth_value(c1, 1) OVER (PARTITION BY c2 ORDER BY c0 ASC) AS cumulative_diff FROM t0;