CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 FLOAT, c3 VARCHAR(10)); INSERT INTO t0 (c0, c1, c2, c3) VALUES (1, 0.01, 100.1, 'A'), (2, 0.02, -200.2, 'B'), (3, 0.03, 300.3, 'C'), (4, 0.04, -400.4, 'A'), (5, 0.05, 500.5, 'B'); SELECT nth_value(c2 / c1, 1) OVER (PARTITION BY c3 ORDER BY c0 DESC ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS division_nth FROM t0;