CREATE TABLE t0 (c0 TEXT, c1 INT); INSERT INTO t0 (c0, c1) VALUES ('A', 1), ('A', 2), ('B', 1), ('B', 1); SELECT c0, c1, COUNT(*) OVER (PARTITION BY c0 ORDER BY c1 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS repeat_count FROM t0;