CREATE TABLE t0 (c0 INT, c1 FLOAT); INSERT INTO t0 (c0, c1) VALUES (1, 0.1), (2, -0.1), (3, 1.5), (4, NULL); SELECT c0, COUNT(*) OVER (PARTITION BY c1 IS NOT NULL) AS non_null_partition_count FROM t0;