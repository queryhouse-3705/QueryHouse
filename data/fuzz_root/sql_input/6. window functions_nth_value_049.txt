CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(10), c3 FLOAT); INSERT INTO t0 (c0, c1, c2, c3) VALUES (5, -123.4, 'teamX', 0.1), (15, 234.5, 'teamY', -0.2), (25, -345.6, 'teamX', 0.3), (35, 456.7, 'teamZ', -0.4), (45, -567.8, 'teamY', 0.5); SELECT nth_value(c1 * c3, 2) OVER (PARTITION BY c2 ORDER BY c0 ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS scaled_product FROM t0;