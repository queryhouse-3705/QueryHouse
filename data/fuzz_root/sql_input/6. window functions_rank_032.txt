CREATE TABLE t0 (c0 FLOAT, c1 JSON, c2 VARCHAR(10)); CREATE TABLE t1 (c0 INTEGER, c1 TEXT, c2 DOUBLE); INSERT INTO t0 (c0, c1, c2) VALUES (1.23, '{"key":"v15"}', 'v16'), (4.56, '{"key":"v17"}', 'v18'), (7.89, '{"key":"v19"}', 'v20'); INSERT INTO t1 (c0, c1, c2) VALUES (10, 'v21', 12.34), (20, 'v22', 56.78), (30, 'v23', 90.12); SELECT t0.c0, t0.c2, t1.c1, RANK() OVER (PARTITION BY t1.c0 ORDER BY t1.c2 DESC) AS rank_value FROM t0 RIGHT JOIN t1 ON ROUND(t0.c0) = t1.c0;