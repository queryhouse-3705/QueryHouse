CREATE TABLE t0 (c0 VARCHAR(10), c1 JSON, c2 INTEGER); CREATE TABLE t1 (c0 FLOAT, c1 DOUBLE, c2 TEXT); INSERT INTO t0 (c0, c1, c2) VALUES ('v18', '{"key":"v19"}', 10), ('v20', '{"key":"v21"}', 20), ('v22', '{"key":"v23"}', 30); INSERT INTO t1 (c0, c1, c2) VALUES (3.14, 2.71, 'v24'), (1.41, 3.14, 'v25'), (2.71, 1.61, 'v26'); SELECT t0.c0, t1.c2, RANK() OVER (PARTITION BY LENGTH(t1.c2) ORDER BY t1.c1) AS rank_value FROM t0 LEFT JOIN t1 ON t0.c2 = ROUND(t1.c1);