CREATE TABLE t0 (c0 INT, c1 TEXT, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (100, 'Alpha', -0.5), (-200, 'Beta', 1.5), (300, 'Alpha', -2.5), (400, 'Gamma', 0.0); SELECT c1, c2, COUNT(*) OVER (PARTITION BY c1 ORDER BY ABS(c2)) AS abs_count FROM t0 WHERE c2 < 0;