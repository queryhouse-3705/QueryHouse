CREATE TABLE t0 (c0 DOUBLE, c1 VARCHAR(20), c2 FLOAT); CREATE TABLE t1 (c0 FLOAT, c1 INTEGER, c2 TEXT); INSERT INTO t0 (c0, c1, c2) VALUES (12.34, 'v19', 123.45), (56.78, 'v20', 456.78), (90.12, 'v21', 789.01); INSERT INTO t1 (c0, c1, c2) VALUES (1.1, 10, 'v22'), (2.2, 20, 'v23'), (3.3, 30, 'v24'); SELECT t1.c0, t0.c2, RANK() OVER (PARTITION BY LENGTH(t1.c2) ORDER BY t0.c0 ASC) AS rank_value FROM t0 LEFT JOIN t1 ON t0.c0 = ROUND(t1.c0);