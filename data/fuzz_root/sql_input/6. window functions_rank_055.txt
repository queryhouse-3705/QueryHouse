CREATE TABLE t0 (c0 DOUBLE, c1 VARCHAR(20), c2 FLOAT); CREATE TABLE t1 (c0 FLOAT, c1 INTEGER, c2 VARCHAR(20)); INSERT INTO t0 (c0, c1, c2) VALUES (123.45, 'v7', 1.23), (456.78, 'v8', 4.56), (789.01, 'v9', 7.89); INSERT INTO t1 (c0, c1, c2) VALUES (1.1, 10, 'v10'), (2.2, 20, 'v11'), (3.3, 30, 'v12'); SELECT t1.c2, t0.c1, RANK() OVER (PARTITION BY t1.c0 ORDER BY t1.c1 DESC) AS rank_value FROM t0 INNER JOIN t1 ON t0.c2 = MOD(t1.c1, 10);