CREATE TABLE t0 (c0 INT, c1 INT, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (1, 100, 1.1), (2, 100, -2.2), (3, 200, 3.3), (4, 300, -4.4); SELECT c0, c1, COUNT(*) OVER (PARTITION BY c1 ORDER BY ABS(c2) ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS cumulative_abs_count FROM t0;