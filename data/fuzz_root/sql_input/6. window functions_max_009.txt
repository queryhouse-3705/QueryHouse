CREATE TABLE t0 (c0 FLOAT, c1 TEXT, c2 INTEGER); INSERT INTO t0 (c0, c1, c2) VALUES (0.1, 'first', 1), (-0.1, 'second', 2), (999.99, NULL, 3); SELECT c2, MAX(c0) OVER (PARTITION BY c1 ORDER BY c0 ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) AS max_c0 FROM t0;