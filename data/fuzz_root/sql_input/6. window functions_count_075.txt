CREATE TABLE t0 (c0 INT, c1 INT, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (1, 10, 1.2), (2, 20, -0.5), (3, 10, 0.1), (4, 30, 1.8); SELECT c1, c2, COUNT(*) OVER (PARTITION BY c1, c2 > 0 ORDER BY c0) AS multi_partition_count FROM t0;