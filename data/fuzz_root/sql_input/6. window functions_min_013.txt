CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (10, 1.5, 0.0001), (-10, -2.5, 0.0002), (20, 3.5, 0.0003), (-20, -4.5, 0.0004); SELECT c1, c0 + MIN(c0) OVER (PARTITION BY c1 > 0 ORDER BY c2 ASC) AS min_adjusted, c2 FROM t0;