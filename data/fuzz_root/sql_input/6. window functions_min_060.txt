CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (1, -1.1, 10.1), (2, 2.2, -20.2), (3, -3.3, 30.3), (4, 4.4, -40.4); SELECT c0, MIN(c1 * c2 + c0) OVER (PARTITION BY c1 < 0 ORDER BY c0 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS min_final_partition FROM t0;