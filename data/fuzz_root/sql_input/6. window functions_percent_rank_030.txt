CREATE TABLE t0(c0 INTEGER, c1 FLOAT, c2 DOUBLE, c3 VARCHAR(5), c4 FLOAT); INSERT INTO t0(c0, c1, c2, c3, c4) VALUES (1, 100.5, 2.1, 'v0', -1.5), (2, -200.7, 3.2, 'v1', 2.5), (3, 300.8, -4.3, 'v2', 3.5), (4, 0.0, 5.4, 'v3', -4.5), (5, 50.6, -6.5, 'v4', 5.5); SELECT c0, c1, c2, c3, c4, PERCENT_RANK() OVER (PARTITION BY c4 < 0 ORDER BY ABS(c1 * c2) + POWER(c4, 2)) AS rank_percent FROM t0;