CREATE TABLE t0 (c0 INTEGER, c1 INTEGER, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (-1, 1, 0.1), (NULL, -1, -0.1), (10, 0, NULL); SELECT c0, MAX(c2) OVER (PARTITION BY c1 ORDER BY c2 ASC NULLS LAST RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS max_c2 FROM t0;