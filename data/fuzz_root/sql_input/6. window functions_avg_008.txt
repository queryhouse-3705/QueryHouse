CREATE TABLE t0 (c0 VARCHAR(50), c1 FLOAT); INSERT INTO t0 (c0, c1) VALUES ('Filter', 0.25), ('Filter', -99999.999), ('Filter', 1000000), ('NoFilter', 500.5); SELECT c0, c1, AVG(c1) OVER(PARTITION BY c0) AS avg_filtered FROM t0 WHERE c0 = 'Filter';