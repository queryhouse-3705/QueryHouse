CREATE TABLE t0 (c0 TEXT, c1 INT, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES ('X', 10, -0.1), ('Y', 20, 1.5), ('X', -10, 2.5), ('Z', 30, -1.5); SELECT c0, c1, c2, COUNT(*) OVER (PARTITION BY c0 ORDER BY ABS(c2)) AS abs_count FROM t0 WHERE c1 BETWEEN 10 AND 30;