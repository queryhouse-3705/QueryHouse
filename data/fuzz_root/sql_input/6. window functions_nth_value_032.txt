CREATE TABLE t0 (c0 INTEGER, c1 DOUBLE, c2 FLOAT, c3 VARCHAR(5)); INSERT INTO t0 (c0, c1, c2, c3) VALUES (10, 100.01, 0.1, 'a'), (20, -200.02, -0.2, 'b'), (30, 300.03, 0.3, 'a'), (40, -400.04, -0.4, 'c'), (50, 500.05, 0.5, 'b'); SELECT nth_value(c2 / c1, 3) OVER (PARTITION BY c3 ORDER BY c0 ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS inverse_ratio FROM t0 WHERE c1 <> 0.0;