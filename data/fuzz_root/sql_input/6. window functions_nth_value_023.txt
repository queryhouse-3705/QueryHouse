CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(10), c3 VARCHAR(10)); INSERT INTO t0 (c0, c1, c2, c3) VALUES (100, 123.4, 'group1', 'typeA'), (200, 234.5, 'group2', 'typeB'), (300, 345.6, 'group1', 'typeA'), (400, 456.7, 'group3', 'typeC'), (500, 567.8, 'group2', 'typeB'); SELECT c3, nth_value(c1, 2) OVER (PARTITION BY c2, c3 ORDER BY c0 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS nth_in_partition FROM t0;