CREATE TABLE t0 (c0 VARCHAR(20), c1 JSON, c2 DOUBLE); CREATE TABLE t1 (c0 FLOAT, c1 TEXT, c2 INTEGER); INSERT INTO t0 (c0, c1, c2) VALUES ('v7', '{"a":"1"}', 1.23), ('v8', '{"b":"2"}', 4.56), ('v9', '{"c":"3"}', 7.89); INSERT INTO t1 (c0, c1, c2) VALUES (1.1, 'v10', 10), (2.2, 'v11', 20), (3.3, 'v12', 30); SELECT t0.c2, t1.c1, RANK() OVER (PARTITION BY LENGTH(t1.c1) ORDER BY t0.c0 ASC) AS rank_value FROM t0 LEFT JOIN t1 ON t0.c2 = t1.c0 * 10;