CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(20)); CREATE TABLE t1 (c0 DOUBLE, c1 TEXT, c2 INTEGER); INSERT INTO t0 (c0, c1, c2) VALUES (1, 1.23, 'v1'), (2, 4.56, 'v2'), (3, 7.89, 'v3'); INSERT INTO t1 (c0, c1, c2) VALUES (123.45, 'v4', 10), (456.78, 'v5', 20), (789.01, 'v6', 30); SELECT t0.c0, t1.c1, RANK() OVER (PARTITION BY t1.c2 ORDER BY t0.c1 DESC NULLS FIRST) AS rank_value FROM t0 INNER JOIN t1 ON t0.c0 = MOD(t1.c2, 3);