CREATE TABLE t0 (c0 FLOAT, c1 VARCHAR(20), c2 DOUBLE); CREATE TABLE t1 (c0 DOUBLE, c1 INTEGER, c2 TEXT); INSERT INTO t0 (c0, c1, c2) VALUES (12.34, 'v19', 123.45), (56.78, 'v20', 456.78), (90.12, 'v21', 789.01); INSERT INTO t1 (c0, c1, c2) VALUES (123.45, 10, 'v22'), (456.78, 20, 'v23'), (789.01, 30, 'v24'); SELECT t1.c2, t0.c1, RANK() OVER (PARTITION BY ROUND(t0.c2) ORDER BY t1.c0 ASC) AS rank_value FROM t0 CROSS JOIN t1;