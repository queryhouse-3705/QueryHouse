CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(5), c3 FLOAT); INSERT INTO t0 (c0, c1, c2, c3) VALUES (9, -1.0, 'alpha', 0.01), (19, 0.0, 'beta', 0.02), (29, 1.0, 'alpha', 0.03), (39, -2.0, 'gamma', 0.04), (49, 3.0, 'beta', 0.05); SELECT nth_value(c1 + c3, 3) OVER (PARTITION BY c2 ORDER BY c0 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) - nth_value(c1, 2) OVER (PARTITION BY c2 ORDER BY c0 DESC) AS delta_value FROM t0;