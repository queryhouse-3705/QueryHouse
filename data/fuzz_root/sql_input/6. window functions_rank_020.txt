CREATE TABLE t0 (c0 TEXT, c1 VARCHAR(10), c2 FLOAT); CREATE TABLE t1 (c0 INTEGER, c1 JSON, c2 DOUBLE); INSERT INTO t0 (c0, c1, c2) VALUES ('v7', 'v8', 12.12), ('v9', 'v10', 34.34), ('v11', 'v12', 56.56); INSERT INTO t1 (c0, c1, c2) VALUES (123, '{"attr":"val"}', 78.78), (456, '{"attr":"val2"}', 90.90), (789, '{"attr":"val3"}', 12.12); SELECT t1.c0, t1.c1, t0.c2, RANK() OVER (PARTITION BY t1.c2 ORDER BY t0.c2 ASC) AS rank_value FROM t0 INNER JOIN t1 ON t0.c2 = t1.c2;