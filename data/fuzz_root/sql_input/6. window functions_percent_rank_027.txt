CREATE TABLE t0(c0 INTEGER, c1 DOUBLE, c2 FLOAT, c3 TEXT, c4 INTEGER); INSERT INTO t0(c0, c1, c2, c3, c4) VALUES (1, 5.5, 2.2, 'alpha', 10), (2, -15.3, 3.3, 'beta', 20), (3, 20.1, -7.2, 'alpha', 10), (4, 25.4, 1.1, 'gamma', 30), (5, -35.6, 4.4, 'delta', 20); SELECT c0, c1, c2, c3, c4, PERCENT_RANK() OVER (PARTITION BY c3, c4 ORDER BY c2 * c1 / NULLIF(c4, 0)) AS rank_percent FROM t0;