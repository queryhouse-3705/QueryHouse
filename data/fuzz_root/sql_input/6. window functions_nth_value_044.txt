CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(10), c3 DOUBLE); INSERT INTO t0 (c0, c1, c2, c3) VALUES (100, 12.34, 'groupX', 1.11), (200, -23.45, 'groupY', -2.22), (300, 34.56, 'groupX', 3.33), (400, -45.67, 'groupZ', -4.44), (500, 56.78, 'groupY', 5.55); SELECT nth_value(c1, 3) OVER (PARTITION BY c2 ORDER BY c0 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) / nth_value(c3, 1) OVER (PARTITION BY c2 ORDER BY c0 DESC) AS division_result FROM t0;