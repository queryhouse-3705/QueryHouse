CREATE TABLE t0 (c0 INT, c1 FLOAT); INSERT INTO t0 (c0, c1) VALUES (1, 50), (2, 100), (3, 150), (4, 200); SELECT c0, c1, AVG(c1) OVER(PARTITION BY CASE WHEN c1 >= 100 THEN 'High' ELSE 'Low' END ORDER BY c0 DESC) AS avg_dynamic_partition FROM t0;