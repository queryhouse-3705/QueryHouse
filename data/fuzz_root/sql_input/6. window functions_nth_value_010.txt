CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(5)); INSERT INTO t0 (c0, c1, c2) VALUES (1, -123.45, 'x'), (2, -234.56, 'y'), (3, -345.67, 'x'), (4, -456.78, 'z'), (5, -567.89, 'y'); SELECT c2, nth_value(c1, 2) OVER (PARTITION BY c2 ORDER BY c0 DESC ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) * c0 AS result FROM t0 WHERE c1 < -200;