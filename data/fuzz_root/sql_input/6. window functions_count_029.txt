CREATE TABLE t0 (c0 INT, c1 VARCHAR(50), c2 INT); INSERT INTO t0 (c0, c1, c2) VALUES (1, 'CEO', NULL), (2, 'Manager A', 1), (3, 'Manager B', 1), (4, 'Employee A1', 2), (5, 'Employee B1', 3); SELECT c1, c2, COUNT(*) OVER (PARTITION BY c2 ORDER BY c0 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS hierarchy_count FROM t0;