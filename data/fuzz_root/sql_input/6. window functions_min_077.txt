CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (50, -5.5, -50.05), (25, 25.6, 25.06), (-50, -75.7, -75.07), (-25, 10.8, 10.08); SELECT c0, c1, MIN(c2 / c0 + c1) OVER (PARTITION BY c2 > 0 ORDER BY c1 ASC ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING) AS min_partitioned_delta FROM t0;