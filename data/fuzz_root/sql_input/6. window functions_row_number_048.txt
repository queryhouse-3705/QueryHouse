CREATE TABLE t0 (c0 TEXT, c1 FLOAT, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES ('v0', 1.5, 10.0), ('v1', 2.5, 20.0), ('v2', 3.5, 10.0), ('v3', 4.5, 30.0); SELECT c0, c1, c2, ROW_NUMBER() OVER (PARTITION BY c2 / 10 ORDER BY c1 DESC, LENGTH(c0)) AS rn FROM t0;