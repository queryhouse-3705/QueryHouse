CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE, c3 JSON, c4 VARCHAR(50), c5 TEXT); INSERT INTO t0 VALUES (1, 10.1, -100.01, '{"key1": "value1"}', 'v1', 'v2'), (2, -20.2, 200.02, '{"key2": 123}', 'v3', 'v4'), (3, 30.3, -300.03, '{"nested": {"key3": "value3"}}', 'v5', 'v6'), (4, -40.4, 400.04, '{"array": [1,2,3]}', 'v7', 'v8'); SELECT c0, MIN(CASE WHEN c2 < 0 THEN ABS(c1 + c2) ELSE c1 * c2 END) OVER (PARTITION BY c4 ORDER BY LENGTH(c5) ASC) AS min_condition FROM t0;