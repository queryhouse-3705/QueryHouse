CREATE TABLE t0 (c0 TEXT, c1 INTEGER, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES ('v0', 1, 1.01), ('v1', 2, 2.02), ('v2', 3, 3.03), ('v3', 4, 4.04); SELECT c0, c1, c2, ROW_NUMBER() OVER (PARTITION BY c1 % 2 ORDER BY c2 DESC, LENGTH(c0)) AS rn FROM t0;