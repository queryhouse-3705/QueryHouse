CREATE TABLE t0 (c0 VARCHAR(50), c1 FLOAT, c2 VARCHAR(20)); INSERT INTO t0 (c0, c1, c2) VALUES ('A', 100, 'Active'), ('A', -200, 'Inactive'), ('B', 300, 'Active'), ('B', -400, 'Inactive'); SELECT c0, c1, c2, AVG(c1) OVER(PARTITION BY c0) AS avg_state FROM t0;