CREATE TABLE t0 (c0 FLOAT, c1 VARCHAR(20), c2 INTEGER); CREATE TABLE t1 (c0 DOUBLE, c1 FLOAT, c2 TEXT); INSERT INTO t0 (c0, c1, c2) VALUES (1.11, 'v25', 10), (2.22, 'v26', 20), (3.33, 'v27', 30); INSERT INTO t1 (c0, c1, c2) VALUES (123.45, 1.23, 'v28'), (456.78, 4.56, 'v29'), (789.01, 7.89, 'v30'); SELECT t0.c2, t1.c2, RANK() OVER (PARTITION BY t0.c1 ORDER BY t1.c0 ASC NULLS LAST) AS rank_value FROM t0 INNER JOIN t1 ON t0.c0 = t1.c1;