CREATE TABLE t0 (c0 JSON, c1 FLOAT, c2 TEXT, c3 DOUBLE, c4 VARCHAR(50)); INSERT INTO t0 VALUES ('{"key": "v0"}', 1.01, 'v1', -10.01, 'v2'), ('{"key": "v3"}', -2.02, 'v4', 20.02, 'v5'), ('{"key": 123}', 3.03, 'v6', -30.03, 'v7'), ('{"array": [1,2]}', -4.04, 'v8', 40.04, 'v9'); SELECT c0, c3, MIN(LENGTH(c2) + c1 * c3) OVER (PARTITION BY c4 ORDER BY c1 RANGE BETWEEN 2 FOLLOWING AND UNBOUNDED FOLLOWING) AS min_advanced FROM t0;