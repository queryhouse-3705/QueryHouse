CREATE TABLE t0 (c0 INTEGER, c1 FLOAT); INSERT INTO t0 (c0, c1) VALUES (1, 100.0), (2, 200.0), (3, -50.0), (4, -150.0), (5, 300.0); SELECT c0, c1, LAG(c1 / 2 + 10) OVER (ORDER BY c1 DESC) AS lag_rank_adjusted FROM t0;