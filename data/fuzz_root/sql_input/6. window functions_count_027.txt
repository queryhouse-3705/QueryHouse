CREATE TABLE t0 (c0 INT, c1 TEXT); INSERT INTO t0 (c0, c1) VALUES (1, 'Parent'), (2, 'Child1'), (3, 'Child2'), (4, 'Child3'); SELECT c0, c1, COUNT(*) OVER (PARTITION BY c1 IN (SELECT c1 FROM t0 WHERE c0 < 3)) AS dynamic_count FROM t0;