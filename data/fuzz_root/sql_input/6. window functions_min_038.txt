CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (10, 100.5, -1000.05), (-10, -200.6, 2000.06), (20, 300.7, -3000.07), (-20, -400.8, 4000.08); SELECT MIN(c2 / c1) OVER (PARTITION BY ABS(c2) > 1000 ORDER BY c0 DESC RANGE BETWEEN 1 FOLLOWING AND 2 FOLLOWING) AS min_ratio_adjusted, c0 FROM t0;