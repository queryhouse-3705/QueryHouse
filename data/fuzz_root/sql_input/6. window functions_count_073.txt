CREATE TABLE t0 (c0 INT, c1 INT); INSERT INTO t0 (c0, c1) VALUES (1, 2), (2, 3), (3, 1), (4, 4); SELECT c0, c1, COUNT(*) OVER (PARTITION BY c1 IN (SELECT c0 FROM t0 WHERE c0 > 2)) AS circular_count FROM t0;