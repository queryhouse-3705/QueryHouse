CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 (c0, c1, c2) VALUES (10, 1.1, 0.01), (20, 2.2, 0.02), (30, 3.3, 0.03), (40, 4.4, 0.04); SELECT c0, c1, c2, ROW_NUMBER() OVER (PARTITION BY c0 ORDER BY c2 DESC, c1 ASC) AS rn FROM t0;