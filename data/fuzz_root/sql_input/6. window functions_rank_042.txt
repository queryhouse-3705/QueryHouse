CREATE TABLE t0 (c0 FLOAT, c1 INTEGER, c2 VARCHAR(20)); CREATE TABLE t1 (c0 DOUBLE, c1 FLOAT, c2 TEXT); INSERT INTO t0 (c0, c1, c2) VALUES (1.23, 10, 'v1'), (4.56, 20, 'v2'), (7.89, 30, 'v3'); INSERT INTO t1 (c0, c1, c2) VALUES (123.45, 1.23, 'v4'), (456.78, 4.56, 'v5'), (789.01, 7.89, 'v6'); SELECT t0.c1, t1.c2, RANK() OVER (PARTITION BY t1.c1 ORDER BY t0.c0 DESC NULLS LAST) AS rank_value FROM t0 INNER JOIN t1 ON t0.c1 = ROUND(t1.c1);