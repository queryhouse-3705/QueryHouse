CREATE TABLE t0 (c0 TEXT, c1 FLOAT, c2 INT); INSERT INTO t0 (c0, c1, c2) VALUES ('Alpha', -1.234, 1), ('Beta', 2.345, -1), ('Gamma', 3.456, 0), ('Delta', -4.567, 1); SELECT c0, c2, COUNT(*) OVER (PARTITION BY c1 > 0 ORDER BY c2 ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS mixed_type_count FROM t0;