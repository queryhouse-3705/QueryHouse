CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 JSON); CREATE TABLE t1 (c0 TEXT, c1 VARCHAR(10), c2 DOUBLE); INSERT INTO t0 (c0, c1, c2) VALUES (1, 1.23, '{"a":"b"}'), (2, 4.56, '{"c":"d"}'), (3, 7.89, '{"e":"f"}'); INSERT INTO t1 (c0, c1, c2) VALUES ('v7', 'v8', 1.23), ('v9', 'v10', 4.56), ('v11', 'v12', 7.89); SELECT t0.c2, t1.c0, RANK() OVER (PARTITION BY LENGTH(t1.c1) ORDER BY t0.c1) AS rank_value FROM t0 LEFT JOIN t1 ON t0.c0 = LENGTH(t1.c1);