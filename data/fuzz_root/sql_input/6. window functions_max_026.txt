CREATE TABLE t0 (c0 INTEGER, c1 FLOAT); INSERT INTO t0 (c0, c1) VALUES (1, 123.456), (2, -789.012), (3, 345.678), (4, -901.234), (5, 567.890); SELECT c0, c1, MAX(c1) OVER (PARTITION BY c0 % 2 ORDER BY c0 ROWS BETWEEN 1 FOLLOWING AND 2 FOLLOWING) AS max_custom_rows FROM t0;