CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(5), c3 FLOAT); INSERT INTO t0 (c0, c1, c2, c3) VALUES (11, 5.67, 'vX', 100.01), (22, -9.87, 'vY', 200.02), (33, 12.34, 'vX', 300.03), (44, 0.0, 'vZ', 400.04), (55, -15.16, 'vY', 500.05); SELECT nth_value(c3 / c1, 3) OVER (PARTITION BY c2 ORDER BY c0 DESC ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) AS result FROM t0 WHERE c1 <> 0.0;