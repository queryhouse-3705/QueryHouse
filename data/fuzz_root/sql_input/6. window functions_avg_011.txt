CREATE TABLE t0 (c0 INT, c1 FLOAT); INSERT INTO t0 (c0, c1) VALUES (1, 10.5), (2, NULL), (3, -20.75), (4, 30.99); SELECT c0, c1, AVG(c1) OVER(ORDER BY c0 ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS avg_with_null FROM t0;