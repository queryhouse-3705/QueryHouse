CREATE TABLE t0 (c0 INTEGER, c1 DOUBLE, c2 VARCHAR(3)); INSERT INTO t0 (c0, c1, c2) VALUES (100, 12345.67, 'X'), (200, 23456.78, 'Y'), (300, 34567.89, 'X'), (400, 45678.90, 'Z'), (500, 56789.01, 'Y'); SELECT nth_value(c1, 2) OVER (PARTITION BY c2 ORDER BY c0 RANGE BETWEEN 100 PRECEDING AND 200 FOLLOWING) AS result FROM t0;