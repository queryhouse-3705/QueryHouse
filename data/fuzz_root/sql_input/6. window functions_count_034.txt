CREATE TABLE t0 (c0 INT, c1 TEXT, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (1, 'Item1', 0.5), (2, 'Item2', -0.5), (3, 'Item3', 1.5), (4, 'Item4', -1.5); SELECT c1, c2, COUNT(*) OVER (PARTITION BY ABS(c2) > 1 ORDER BY c0 ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS dynamic_value_count FROM t0;