CREATE TABLE t0 (c0 DOUBLE, c1 FLOAT, c2 VARCHAR(20)); CREATE TABLE t1 (c0 FLOAT, c1 TEXT, c2 DOUBLE); INSERT INTO t0 (c0, c1, c2) VALUES (12.34, 1.1, 'v19'), (56.78, 2.2, 'v20'), (90.12, 3.3, 'v21'); INSERT INTO t1 (c0, c1, c2) VALUES (1.23, 'v22', 123.45), (4.56, 'v23', 456.78), (7.89, 'v24', 789.01); SELECT t0.c2, t1.c1, RANK() OVER (PARTITION BY ROUND(t1.c2) ORDER BY t0.c1 ASC NULLS FIRST) AS rank_value FROM t0 LEFT JOIN t1 ON t0.c1 = t1.c2;