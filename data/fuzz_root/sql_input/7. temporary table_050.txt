CREATE TEMPORARY TABLE t0 (c0 INTEGER, c1 VARCHAR(25), c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (15, 'v0', 2.5), (30, 'v1', 3.5), (45, 'v2', 4.5); SELECT c0 / 15 AS step_value, AVG(c2) OVER (ORDER BY c0) AS rolling_avg FROM t0;