CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(5), c3 DOUBLE); INSERT INTO t0 (c0, c1, c2, c3) VALUES (11, 100.1, 'teamA', -0.11), (22, -200.2, 'teamB', 0.22), (33, 300.3, 'teamA', -0.33), (44, -400.4, 'teamC', 0.44), (55, 500.5, 'teamB', -0.55); SELECT nth_value(c1, 3) OVER (PARTITION BY c2 ORDER BY c0 DESC RANGE BETWEEN 2 FOLLOWING AND UNBOUNDED FOLLOWING) AS rolling_metric FROM t0;