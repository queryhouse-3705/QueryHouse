CREATE TABLE t0 (c0 VARCHAR(15), c1 DOUBLE); INSERT INTO t0 (c0, c1) VALUES ('longstring', 100.1), ('short', -200.2), ('tiny', 300.3), ('medium', -400.4), ('huge', 500.5); SELECT c0, c1, MAX(c1) OVER (PARTITION BY LENGTH(c0) ORDER BY c1 RANGE BETWEEN 1 PRECEDING AND 2 FOLLOWING) AS max_varchar_range FROM t0;