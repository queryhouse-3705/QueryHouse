CREATE TABLE t0 (c0 INTEGER, c1 TEXT, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (100, 'alpha', 1.0), (200, 'beta', 2.0), (300, 'gamma', 3.0), (100, 'delta', 4.0); SELECT c0, c1, c2, ROW_NUMBER() OVER (PARTITION BY c0 / 100 ORDER BY c2 ASC, c1) AS rn FROM t0;