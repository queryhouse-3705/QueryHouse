CREATE TABLE t0 (c0 VARCHAR(50), c1 FLOAT, c2 INT); INSERT INTO t0 (c0, c1, c2) VALUES ('GroupA', 10, 1), ('GroupA', 20, 2), ('GroupB', 30, 3), ('GroupB', 40, 4); SELECT c0, c1, c2, AVG(c1) OVER(PARTITION BY c0 ORDER BY c2 ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS avg_group_moving FROM t0;