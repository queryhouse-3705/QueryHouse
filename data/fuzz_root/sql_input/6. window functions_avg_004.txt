CREATE TABLE t0 (c0 VARCHAR(50), c1 FLOAT, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES ('Group1', -500.5, 1), ('Group1', 1000.01, 2), ('Group2', -0.001, 1), ('Group2', 2500000.5, 2); SELECT c0, c1, c2, AVG(c1) OVER(PARTITION BY c0 ORDER BY c2) AS avg_running FROM t0;