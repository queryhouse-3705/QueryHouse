CREATE TABLE t0 (c0 INT, c1 INT, c2 TEXT); INSERT INTO t0 (c0, c1, c2) VALUES (1, NULL, 'Root'), (2, 1, 'Branch1'), (3, 1, 'Branch2'), (4, 2, 'Leaf'); SELECT c0, c1, COUNT(*) OVER (PARTITION BY c1 ORDER BY c0 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS hierarchy_count FROM t0;