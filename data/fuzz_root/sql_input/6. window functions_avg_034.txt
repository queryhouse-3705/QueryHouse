CREATE TABLE t0 (c0 INT, c1 FLOAT, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (1, 100, 0.1), (2, 200, 0.2), (3, 300, 0.15), (4, 400, 0.05); SELECT c0, c1, c2, AVG(c1 * c2) OVER(ORDER BY c0 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS avg_weighted_growth FROM t0;