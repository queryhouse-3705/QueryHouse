CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (5, -5.5, 50.5), (-5, 5.6, -60.6), (15, -15.7, 150.7), (-15, 15.8, -160.8); SELECT c0, c1, MIN(c2 - c1 * c0) OVER (PARTITION BY SIGN(c1) ORDER BY c1 ASC ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING) AS min_adjusted_delta FROM t0;