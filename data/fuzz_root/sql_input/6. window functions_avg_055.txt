CREATE TABLE t0 (c0 INT, c1 FLOAT, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (1, 10, 1), (2, 20, 2), (3, 30, 3), (4, 40, 4); SELECT c0, c1, c2, SUM(c1 * c2) OVER() / SUM(c2) OVER() AS weighted_avg FROM t0;