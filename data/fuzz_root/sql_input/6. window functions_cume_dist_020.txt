CREATE TABLE t0 (c0 INT, c1 INT, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (1, NULL, 10.1), (2, 1, -20.2), (3, 2, 30.3), (4, 3, -40.4); SELECT c0, c1, c2, CUME_DIST() OVER (PARTITION BY c1 IN (SELECT c0 FROM t0 WHERE c2 > 0) ORDER BY ABS(c2)) AS hierarchy_dist FROM t0;