CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 TEXT); CREATE TABLE t1 (c0 JSON, c1 VARCHAR(20), c2 INTEGER); INSERT INTO t0 (c0, c1, c2) VALUES (10, 1.23, 'v0'), (20, 4.56, 'v1'), (30, 1.23, 'v2'); INSERT INTO t1 (c0, c1, c2) VALUES ('{"key":"value"}', 'v3', 100), ('{"key":"value2"}', 'v4', 200), ('{"key":"value3"}', 'v5', 300); SELECT t0.c0, t0.c1, t0.c2, t1.c1, RANK() OVER (PARTITION BY t0.c2 ORDER BY t1.c2) AS rank_value FROM t0 INNER JOIN t1 ON t0.c0 = t1.c2 % 10;