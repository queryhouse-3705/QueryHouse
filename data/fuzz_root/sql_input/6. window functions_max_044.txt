CREATE TABLE t0 (c0 INTEGER, c1 DOUBLE); INSERT INTO t0 (c0, c1) VALUES (100, 1000.1), (-200, 2000.2), (300, -3000.3), (-400, -4000.4), (500, 0.0); SELECT c0, c1, MAX(c1) OVER (PARTITION BY (c0 % 2) ORDER BY ABS(c1) ROWS BETWEEN 2 PRECEDING AND 2 FOLLOWING) AS max_advanced_partition FROM t0;