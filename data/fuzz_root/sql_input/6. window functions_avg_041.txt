CREATE TABLE t0 (c0 INT, c1 FLOAT); INSERT INTO t0 (c0, c1) VALUES (1, 50), (2, 100), (3, 150), (4, 200); SELECT c0, c1, AVG(c1) OVER(PARTITION BY CASE WHEN c0 <= 2 THEN 'FirstHalf' ELSE 'SecondHalf' END) AS avg_by_intervals FROM t0;