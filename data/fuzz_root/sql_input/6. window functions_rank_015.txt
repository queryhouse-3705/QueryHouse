CREATE TABLE t0 (c0 JSON, c1 INTEGER, c2 DOUBLE); CREATE TABLE t1 (c0 FLOAT, c1 TEXT, c2 VARCHAR(10)); INSERT INTO t0 (c0, c1, c2) VALUES ('{"a":1}', 100, 123.45), ('{"a":2}', 200, 456.78), ('{"a":3}', 300, 123.45); INSERT INTO t1 (c0, c1, c2) VALUES (1.23, 'v6', 'v7'), (4.56, 'v8', 'v9'), (7.89, 'v10', 'v11'); SELECT t0.c0, t1.c1, RANK() OVER (PARTITION BY t0.c1 ORDER BY t1.c0 DESC) AS rank_value FROM t0 CROSS JOIN t1;