CREATE TABLE t0 (c0 INTEGER, c1 INTEGER, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (1, 2, 3.3), (4, 5, NULL), (7, NULL, 9.9), (10, 2, 3.3), (13, NULL, NULL); SELECT c0, c1, c2, RANK() OVER (PARTITION BY c1 ORDER BY c2 NULLS LAST) AS rank_value FROM t0;