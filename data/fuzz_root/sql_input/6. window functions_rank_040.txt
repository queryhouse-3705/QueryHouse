CREATE TABLE t0 (c0 DOUBLE, c1 VARCHAR(20), c2 FLOAT); CREATE TABLE t1 (c0 INTEGER, c1 DOUBLE, c2 TEXT); INSERT INTO t0 (c0, c1, c2) VALUES (123.45, 'v28', 1.1), (456.78, 'v29', 2.2), (789.01, 'v30', 3.3); INSERT INTO t1 (c0, c1, c2) VALUES (10, 1.23, 'v31'), (20, 4.56, 'v32'), (30, 7.89, 'v33'); SELECT t0.c1, t1.c2, RANK() OVER (PARTITION BY MOD(t1.c0, 3) ORDER BY t0.c0 NULLS FIRST) AS rank_value FROM t0 LEFT JOIN t1 ON t0.c2 = t1.c1 / 10;