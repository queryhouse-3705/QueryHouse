CREATE TABLE t0(c0 INTEGER, c1 FLOAT, c2 TEXT); INSERT INTO t0 VALUES (1, 0.123, 'v0'), (1, 0.124, 'v1'), (2, 0.125, 'v2'), (2, 0.126, 'v3'), (3, 0.127, 'v4'); SELECT c0, NTILE(4) OVER (PARTITION BY c1 * 100 ORDER BY c0 / 2) AS ntile_rank FROM t0;