CREATE TABLE t0 (c0 INTEGER, c1 DOUBLE, c2 FLOAT, c3 VARCHAR(10)); INSERT INTO t0 (c0, c1, c2, c3) VALUES (10, 10.1, 0.1, 'X'), (20, 20.2, -0.2, 'Y'), (30, -30.3, 0.3, 'X'), (40, 40.4, -0.4, 'Z'), (50, -50.5, 0.5, 'Y'); SELECT nth_value(c1 * c2, 2) OVER (PARTITION BY c3 ORDER BY c0 ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) + nth_value(c2, 1) OVER (PARTITION BY c3 ORDER BY c0 DESC) AS complex_sum FROM t0;