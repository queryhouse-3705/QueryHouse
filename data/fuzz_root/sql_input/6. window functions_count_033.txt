CREATE TABLE t0 (c0 INT, c1 INT, c2 INT); INSERT INTO t0 (c0, c1, c2) VALUES (1, NULL, 2), (2, 1, 3), (3, 2, 4), (4, 3, NULL); SELECT c0, c1, c2, COUNT(*) OVER (PARTITION BY c1 ORDER BY c2) AS recursive_count FROM t0;