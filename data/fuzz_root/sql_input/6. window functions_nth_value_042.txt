CREATE TABLE t0 (c0 INTEGER, c1 DOUBLE, c2 FLOAT, c3 VARCHAR(10)); INSERT INTO t0 (c0, c1, c2, c3) VALUES (10, 1000.1, -1.1, 'groupA'), (20, -2000.2, 2.2, 'groupB'), (30, 3000.3, -3.3, 'groupA'), (40, -4000.4, 4.4, 'groupC'), (50, 5000.5, -5.5, 'groupB'); SELECT nth_value(c1 / c2, 2) OVER (PARTITION BY c3 ORDER BY c0 ROWS BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS adjusted_ratio FROM t0;