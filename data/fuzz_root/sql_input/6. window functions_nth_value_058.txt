CREATE TABLE t0 (c0 INTEGER, c1 DOUBLE, c2 FLOAT, c3 VARCHAR(5)); INSERT INTO t0 (c0, c1, c2, c3) VALUES (11, 1000.1, -0.01, 'A'), (22, -2000.2, 0.02, 'B'), (33, 3000.3, -0.03, 'A'), (44, -4000.4, 0.04, 'C'), (55, 5000.5, -0.05, 'B'); SELECT nth_value(c2 * c1, 2) OVER (PARTITION BY c3 ORDER BY c0 ROWS BETWEEN CURRENT ROW AND 2 FOLLOWING) AS scaled_value FROM t0;