CREATE TABLE t1 (c0 TEXT, c1 INTEGER); CREATE TABLE t2 (c0 TEXT, c1 INTEGER, c2 TEXT); INSERT INTO t1 (c0, c1) VALUES ('v0', 10), ('v1', 20), ('v2', 30); INSERT INTO t2 (c0, c1, c2) VALUES ('v0', 25, 'A'), ('v1', 15, 'B'), ('v2', 35, 'C'); WITH t0 AS (SELECT t1.c0, CASE WHEN t2.c1 > 20 THEN 'High' ELSE 'Low' END AS category FROM t1 JOIN t2 ON t1.c0 = t2.c0) SELECT t0.c0, t0.category FROM t0;