CREATE TABLE t0(c0 INTEGER, c1 DOUBLE, c2 FLOAT); INSERT INTO t0(c0, c1, c2) VALUES (1, 0.01, 0.02), (2, 0.02, 0.03), (3, 0.03, 0.01), (4, 0.04, 0.05), (5, 0.05, 0.04); SELECT c0, c1, c2, PERCENT_RANK() OVER (PARTITION BY c2 / c1 ORDER BY ABS(c1 - c2)) AS rank_percent FROM t0;