CREATE TABLE t0 (c0 INTEGER, c1 DOUBLE, c2 VARCHAR(3), c3 FLOAT); INSERT INTO t0 (c0, c1, c2, c3) VALUES (5, -9.87, 'x', 0.01), (15, 0.00, 'y', -0.02), (25, 10.12, 'z', 0.03), (35, 20.24, 'x', 0.04), (45, 30.36, 'y', 0.05); SELECT c2, nth_value(c1 * c3, 3) OVER (PARTITION BY c2 ORDER BY c0 RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) AS adjusted_product FROM t0 WHERE c1 <> 0.0;