CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (50, -5.05, 50.05), (-50, 10.06, -100.06), (100, -15.07, 150.07), (-100, 20.08, -200.08); SELECT MIN(ABS(c1)) OVER (PARTITION BY c2 < 0 ORDER BY c0 RANGE BETWEEN CURRENT ROW AND 3 FOLLOWING) AS min_abs_window, c1, c2 FROM t0;