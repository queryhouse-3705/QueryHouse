CREATE TABLE t0 (c0 INT, c1 TEXT, c2 INT); INSERT INTO t0 (c0, c1, c2) VALUES (1, 'Group A', 10), (2, 'Group A', 20), (3, 'Group B', 10), (4, 'Group B', 30); SELECT c1, c2, COUNT(*) OVER (PARTITION BY c1 ORDER BY c2 ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS group_count FROM t0;