CREATE TABLE t0 (c0 VARCHAR(10), c1 JSON, c2 FLOAT); CREATE TABLE t1 (c0 TEXT, c1 DOUBLE, c2 INTEGER); INSERT INTO t0 (c0, c1, c2) VALUES ('v12', '{"attr":"value"}', 12.34), ('v13', '{"attr":"value2"}', 56.78), ('v14', '{"attr":"value3"}', 90.12); INSERT INTO t1 (c0, c1, c2) VALUES ('v15', 123.456, 10), ('v16', 789.012, 20), ('v17', 345.678, 30); SELECT t0.c0, t1.c0, t1.c1, RANK() OVER (PARTITION BY LENGTH(t1.c0) ORDER BY t1.c1) AS rank_value FROM t0 INNER JOIN t1 ON t0.c2 = t1.c1 / 10;