CREATE TABLE t0 (c0 VARCHAR(50), c1 FLOAT, c2 INT); INSERT INTO t0 (c0, c1, c2) VALUES ('Tiny', -12345.678, 1), ('Small', 98765.4321, -2), ('MediumLength', 1234567.8901, 3), ('VeryVeryLongText', -9876543.21098, -4); SELECT c0, c2, CUME_DIST() OVER (PARTITION BY LENGTH(c0) > 5 ORDER BY ABS(c1)) AS text_abs_dist FROM t0;