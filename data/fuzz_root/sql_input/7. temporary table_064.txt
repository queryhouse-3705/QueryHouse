CREATE TEMPORARY TABLE t0 (c0 INTEGER, c1 VARCHAR(25), c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (100, 'v0', -0.1), (200, 'v1', 0.2), (300, 'v2', -0.3); SELECT c1, ROW_NUMBER() OVER (ORDER BY c2 DESC) * CASE WHEN c0 > 0 THEN c0 ELSE c2 END AS computed_order FROM t0;