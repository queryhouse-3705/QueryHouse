CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(10), c3 FLOAT); INSERT INTO t0 (c0, c1, c2, c3) VALUES (1, -5.123, 'categoryA', 0.01), (2, 6.234, 'categoryB', -0.02), (3, -7.345, 'categoryA', 0.03), (4, 8.456, 'categoryC', -0.04), (5, -9.567, 'categoryB', 0.05); SELECT nth_value(c1 * c3, 1) OVER (PARTITION BY c2 ORDER BY c0 RANGE BETWEEN 1 FOLLOWING AND UNBOUNDED FOLLOWING) AS weighted_result FROM t0;