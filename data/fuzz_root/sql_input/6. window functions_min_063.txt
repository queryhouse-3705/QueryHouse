CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (123, 123.123, -1234.123), (456, -456.456, 4567.456), (-789, 789.789, -7890.789), (101, -101.101, 1010.101); SELECT c1, c0, MIN(c1 * c2 + c0) OVER (PARTITION BY c0 % 3 = 0 ORDER BY c2 ASC RANGE BETWEEN CURRENT ROW AND 3 FOLLOWING) AS min_combined FROM t0;