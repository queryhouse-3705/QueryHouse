CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (10, 0.5, -5.5), (-10, -0.6, 6.6), (20, 0.7, -7.7), (-20, -0.8, 8.8); SELECT c0, c1, MIN(c2 * c1 / c0) OVER (PARTITION BY SIGN(c0) ORDER BY c1 DESC ROWS BETWEEN 1 PRECEDING AND 2 FOLLOWING) AS min_transformed_partition FROM t0;