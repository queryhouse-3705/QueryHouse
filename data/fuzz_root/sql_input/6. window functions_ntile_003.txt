CREATE TABLE t0(c0 INTEGER, c1 DOUBLE, c2 VARCHAR(30)); INSERT INTO t0 VALUES (1, 3.14159, 'v0 pi'), (2, -3.14159, 'v1 neg_pi'), (3, 2.71828, 'v2 e'), (4, 0.0, 'v3 zero'), (5, 1.61803, 'v4 phi'); SELECT c1, c2, NTILE(3) OVER (ORDER BY c1, c2 DESC) AS ntile_rank FROM t0;