CREATE TABLE t0(c0 INTEGER, c1 FLOAT, c2 TEXT, c3 DOUBLE, c4 FLOAT); INSERT INTO t0(c0, c1, c2, c3, c4) VALUES (1, 1.1, 'alpha', -2.2, 3.3), (2, -1.2, 'beta', 4.4, -5.5), (3, 1.3, 'gamma', -6.6, 7.7), (4, -1.4, 'delta', 8.8, -9.9), (5, 1.5, 'epsilon', -10.1, 11.1); SELECT c0, c1, c2, c3, c4, PERCENT_RANK() OVER (PARTITION BY c2 ORDER BY ABS(c1 * c3) + c4 * SIGN(c1) DESC) AS rank_percent FROM t0;