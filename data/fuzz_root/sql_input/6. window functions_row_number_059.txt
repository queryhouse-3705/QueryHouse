CREATE TABLE t0 (c0 TEXT, c1 INTEGER, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES ('x', 100, 1.1), ('y', 200, 2.2), ('z', 100, 3.3), ('w', 300, 4.4); SELECT c0, c1, c2, ROW_NUMBER() OVER (PARTITION BY c1 / 100 ORDER BY c2 * c1 DESC, c0 ASC) AS rn FROM t0;