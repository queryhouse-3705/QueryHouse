CREATE TABLE t0 (c0 DOUBLE, c1 FLOAT, c2 TEXT); CREATE TABLE t1 (c0 VARCHAR(20), c1 DOUBLE, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (1.23, 123.45, 'v25'), (4.56, 456.78, 'v26'), (7.89, 789.01, 'v27'); INSERT INTO t1 (c0, c1, c2) VALUES ('v28', 1.1, 123.45), ('v29', 2.2, 456.78), ('v30', 3.3, 789.01); SELECT t0.c2, t1.c1, RANK() OVER (PARTITION BY ROUND(t1.c2) ORDER BY t0.c1 ASC) AS rank_value FROM t0 LEFT JOIN t1 ON t0.c0 = t1.c2;