CREATE TABLE t0 (c0 INT, c1 FLOAT); INSERT INTO t0 (c0, c1) VALUES (1, 0.1), (2, 50000), (3, -0.1), (4, 0.00001), (5, -50000); SELECT c0, c1, AVG(c1) OVER(ORDER BY c0 ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS avg_variable_range FROM t0;