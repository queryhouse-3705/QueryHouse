CREATE TABLE t0 (c0 DOUBLE, c1 INTEGER, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (123.456, 10, 0.01), (-123.456, -10, -0.01), (0.0, 0, NULL); SELECT c1, MAX(c2) OVER (PARTITION BY c0 ORDER BY c2 ROWS BETWEEN 1 PRECEDING AND 1 FOLLOWING) AS max_c2 FROM t0;