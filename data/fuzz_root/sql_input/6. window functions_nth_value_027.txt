CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(10), c3 DOUBLE); INSERT INTO t0 (c0, c1, c2, c3) VALUES (100, -123.45, 'grp1', 1.1), (200, 234.56, 'grp2', 2.2), (300, -345.67, 'grp1', 3.3), (400, 456.78, 'grp3', 4.4), (500, -567.89, 'grp2', 5.5); SELECT nth_value(c3 * c1, 2) OVER (PARTITION BY c2 ORDER BY c0 RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) - nth_value(c1, 1) OVER (ORDER BY c0) AS adjusted_diff FROM t0;