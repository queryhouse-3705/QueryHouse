CREATE TABLE t0 (c0 DOUBLE, c1 TEXT, c2 INTEGER); INSERT INTO t0 (c0, c1, c2) VALUES (1.23, 'alpha', 1), (-1.23, 'beta', 2), (0.0, NULL, 3); SELECT c2, MAX(c0) OVER (PARTITION BY c1 ORDER BY c2 ASC ROWS BETWEEN 2 PRECEDING AND CURRENT ROW) AS max_c0 FROM t0;