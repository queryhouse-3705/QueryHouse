CREATE TABLE t0 (c0 INTEGER, c1 TEXT, c2 JSON); CREATE TABLE t1 (c0 DOUBLE, c1 FLOAT, c2 VARCHAR(20)); INSERT INTO t0 (c0, c1, c2) VALUES (10, 'v0', '{"key1":"value1"}'), (20, 'v1', '{"key2":"value2"}'), (30, 'v2', '{"key3":"value3"}'); INSERT INTO t1 (c0, c1, c2) VALUES (1.23, 4.56, 'v3'), (7.89, 12.34, 'v4'), (56.78, 90.12, 'v5'); SELECT t0.c0, t0.c1, t1.c2, RANK() OVER (PARTITION BY t0.c1 ORDER BY t1.c1 DESC NULLS FIRST) AS rank_value FROM t0 INNER JOIN t1 ON t0.c0 = FLOOR(t1.c0);