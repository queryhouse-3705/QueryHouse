CREATE TABLE t0 (c0 DOUBLE, c1 TEXT, c2 DOUBLE); INSERT INTO t0 (c0, c1, c2) VALUES (0.1, 'v0', 1.5), (0.2, 'v1', 2.5), (0.3, 'v2', 3.5), (0.1, 'v3', 4.5); SELECT c0, c1, c2, ROW_NUMBER() OVER (PARTITION BY c0 ORDER BY c2 DESC, c1 ASC) AS rn FROM t0;