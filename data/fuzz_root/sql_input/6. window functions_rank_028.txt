CREATE TABLE t0 (c0 VARCHAR(20), c1 JSON, c2 FLOAT); CREATE TABLE t1 (c0 FLOAT, c1 VARCHAR(20), c2 DOUBLE); INSERT INTO t0 (c0, c1, c2) VALUES ('v7', '{"k1":"v1"}', 12.34), ('v8', '{"k2":"v2"}', 56.78), ('v9', '{"k3":"v3"}', 90.12); INSERT INTO t1 (c0, c1, c2) VALUES (1.1, 'v10', 1.11), (2.2, 'v11', 2.22), (3.3, 'v12', 3.33); SELECT t0.c2, t1.c1, RANK() OVER (PARTITION BY LENGTH(t1.c1) ORDER BY t1.c2 DESC) AS rank_value FROM t0 LEFT JOIN t1 ON t0.c2 = t1.c2 * 10;