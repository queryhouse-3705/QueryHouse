CREATE TABLE t0 (c0 INT, c1 TEXT); CREATE TABLE t1 (c0 INT, c1 INT); INSERT INTO t0 (c0, c1) VALUES (1, 'A'), (2, 'B'), (3, 'A'); INSERT INTO t1 (c0, c1) VALUES (1, 100), (2, 200), (3, 300); SELECT t0.c1, COUNT(*) OVER (PARTITION BY t0.c1 ORDER BY t1.c1) AS group_count FROM t0 JOIN t1 ON t0.c0 = t1.c0;