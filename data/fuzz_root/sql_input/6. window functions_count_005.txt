CREATE TABLE t0 (c0 FLOAT, c1 INT); INSERT INTO t0 (c0, c1) VALUES (3.14, 2), (-2.71, -1), (1.62, 0), (-1.41, 1); CREATE TABLE t1 (c0 INT, c1 FLOAT); INSERT INTO t1 (c0, c1) VALUES (10, 0.1), (-20, -0.1), (30, 1.5), (-40, -1.5); SELECT t0.c0, t1.c1, COUNT(*) OVER (ORDER BY t1.c1) AS ratio_count FROM t0 JOIN t1 ON ROUND(t0.c0) = ROUND(t1.c1); SELECT * FROM t0; SELECT t1.c0, COUNT(*) OVER (PARTITION BY t1.c1) FROM t1;