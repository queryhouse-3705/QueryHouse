CREATE TABLE t0 (c0 INT, c1 INT, c2 VARCHAR(50)); INSERT INTO t0 (c0, c1, c2) VALUES (1, NULL, 'Root'), (2, 1, 'Child1'), (3, 1, 'Child2'), (4, 2, 'Leaf'); SELECT c2, COUNT(*) OVER (PARTITION BY c1 ORDER BY c0 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS hierarchy_count FROM t0;