CREATE TABLE t0 (c0 VARCHAR(10), c1 DOUBLE); INSERT INTO t0 (c0, c1) VALUES ('v0', 10.1), ('v1', -20.2), ('v2', 30.3), ('v3', -40.4), ('v4', 50.5); SELECT c0, c1, MAX(c1) OVER (PARTITION BY LENGTH(c0) ORDER BY ABS(c1) ROWS BETWEEN 1 PRECEDING AND 2 FOLLOWING) AS max_varchar_abs FROM t0;