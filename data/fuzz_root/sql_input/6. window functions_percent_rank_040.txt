CREATE TABLE t0(c0 INTEGER, c1 FLOAT, c2 TEXT, c3 DOUBLE, c4 DOUBLE); INSERT INTO t0(c0, c1, c2, c3, c4) VALUES (1, 0.01, 'v0', -0.5, 1.1), (2, -0.02, 'v1', 0.5, -1.2), (3, 0.03, 'v2', -1.5, 1.3), (4, -0.04, 'v3', 1.5, -1.4), (5, 0.05, 'v4', -2.5, 1.5); SELECT c0, c1, c2, c3, c4, PERCENT_RANK() OVER (PARTITION BY c2 ORDER BY ABS(c1 + c3 * c4) DESC) AS rank_percent FROM t0;