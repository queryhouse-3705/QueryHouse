CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 VALUES (123, 1.23, -123.123), (456, -4.56, 456.456), (-789, 7.89, -789.789), (-101, -10.1, 101.101); SELECT c1, c0, MIN(c0) OVER (PARTITION BY ABS(c0) > 100 ORDER BY c2 DESC ROWS BETWEEN 1 PRECEDING AND 2 FOLLOWING) AS min_adjusted FROM t0;