CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(10)); INSERT INTO t0 (c0, c1, c2) VALUES (100, 0.1, 'a'), (200, 0.2, 'b'), (300, 0.3, 'a'), (400, 0.4, 'c'), (500, 0.5, 'b'); SELECT c0, nth_value(c1, 3) OVER (ORDER BY c2 DESC, c0) AS result FROM t0 WHERE c0 > 150;