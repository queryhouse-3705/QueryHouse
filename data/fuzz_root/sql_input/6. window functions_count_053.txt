CREATE TABLE t0 (c0 INT, c1 INT); INSERT INTO t0 (c0, c1) VALUES (1, NULL), (2, 1), (3, 2), (4, 3); SELECT c0, c1, COUNT(*) OVER (PARTITION BY c1 ORDER BY c0 ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS dynamic_count FROM t0;