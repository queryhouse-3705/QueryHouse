CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (1, 0.0, -0.00001), (2, 123456.789, 987654.321), (3, -1.414213, 1.732050), (4, 999.99, -999.99), (5, -3.14159, 2.71828); SELECT c0, c1, c2, CUME_DIST() OVER (ORDER BY (CASE WHEN c1 > 0 THEN c2 ELSE c1 END)) AS dist FROM t0;