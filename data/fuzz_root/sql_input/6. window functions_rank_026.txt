CREATE TABLE t0 (c0 JSON, c1 DOUBLE, c2 VARCHAR(10)); CREATE TABLE t1 (c0 FLOAT, c1 TEXT, c2 INTEGER); INSERT INTO t0 (c0, c1, c2) VALUES ('{"key1":"value1"}', 12.34, 'v1'), ('{"key2":"value2"}', 56.78, 'v2'), ('{"key3":"value3"}', 90.12, 'v3'); INSERT INTO t1 (c0, c1, c2) VALUES (1.1, 'v4', 10), (2.2, 'v5', 20), (3.3, 'v6', 30); SELECT t0.c0, t1.c1, RANK() OVER (PARTITION BY t1.c2 ORDER BY t0.c1 ASC) AS rank_value FROM t0 INNER JOIN t1 ON t0.c1 = t1.c0 * 10;