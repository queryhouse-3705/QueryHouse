CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(5)); INSERT INTO t0 (c0, c1, c2) VALUES (11, -10.1, 'alpha'), (12, 20.2, 'beta'), (13, -30.3, 'alpha'), (14, 40.4, 'gamma'), (15, -50.5, 'beta'); SELECT nth_value(c1, 3) OVER (PARTITION BY c2 ORDER BY c0 RANGE BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) + nth_value(c1, 1) OVER (PARTITION BY c2 ORDER BY c0 DESC) AS total FROM t0;