CREATE TABLE t0 (c0 TEXT, c1 FLOAT, c2 DOUBLE, c3 INTEGER); INSERT INTO t0 (c0, c1, c2, c3) VALUES ('v0', 1.01, 0.1, 100), ('v1', 2.02, 0.2, 200), ('v2', 3.03, 0.3, 300), ('v3', 4.04, 0.4, 100); SELECT c0, c1, c2, c3, ROW_NUMBER() OVER (PARTITION BY c3 ORDER BY c1 DESC, c2 ASC) AS rn FROM t0;