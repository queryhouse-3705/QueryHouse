CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 DOUBLE); INSERT INTO t0 (c0, c1, c2) VALUES (1, 0.0, 0.00001), (2, -1.1, -2.2), (3, 2.2, 3.3), (4, -3.3, -4.4), (5, 4.4, 5.5); SELECT nth_value(c2, 3) OVER (ORDER BY c1 DESC RANGE BETWEEN CURRENT ROW AND UNBOUNDED FOLLOWING) / nth_value(c1, 2) OVER (PARTITION BY c0 ORDER BY c2) AS calc_result FROM t0;