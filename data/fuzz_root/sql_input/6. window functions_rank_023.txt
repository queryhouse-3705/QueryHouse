CREATE TABLE t0 (c0 FLOAT, c1 DOUBLE, c2 VARCHAR(20)); CREATE TABLE t1 (c0 JSON, c1 TEXT, c2 INTEGER); INSERT INTO t0 (c0, c1, c2) VALUES (12.34, 123.456, 'v13'), (45.67, 789.012, 'v14'), (89.01, 456.789, 'v15'); INSERT INTO t1 (c0, c1, c2) VALUES ('{"key1":"val1"}', 'v16', 1), ('{"key2":"val2"}', 'v17', 2), ('{"key3":"val3"}', 'v18', 3); SELECT t0.c2, t1.c1, RANK() OVER (PARTITION BY t1.c2 ORDER BY t0.c0 NULLS FIRST) AS rank_value FROM t0 CROSS JOIN t1;