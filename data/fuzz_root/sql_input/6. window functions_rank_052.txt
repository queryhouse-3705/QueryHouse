CREATE TABLE t0 (c0 INTEGER, c1 FLOAT, c2 VARCHAR(20)); CREATE TABLE t1 (c0 DOUBLE, c1 TEXT, c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (10, 1.1, 'v13'), (20, 2.2, 'v14'), (30, 3.3, 'v15'); INSERT INTO t1 (c0, c1, c2) VALUES (123.45, 'v16', 10.1), (456.78, 'v17', 20.2), (789.01, 'v18', 30.3); SELECT t1.c2, t0.c1, RANK() OVER (PARTITION BY t1.c0 ORDER BY t0.c1 DESC) AS rank_value FROM t0 INNER JOIN t1 ON t0.c1 = ROUND(t1.c2);