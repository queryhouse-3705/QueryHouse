CREATE TABLE t0 (c0 VARCHAR(50), c1 FLOAT, c2 INT); INSERT INTO t0 (c0, c1, c2) VALUES ('Group1', -100.5, 1), ('Group1', 200.5, 2), ('Group2', -300.5, 1), ('Group2', 400.5, 2); SELECT c0, c1, c2, AVG(c1) OVER(PARTITION BY c0 ORDER BY c2 ROWS BETWEEN UNBOUNDED PRECEDING AND CURRENT ROW) AS avg_dynamic FROM t0;