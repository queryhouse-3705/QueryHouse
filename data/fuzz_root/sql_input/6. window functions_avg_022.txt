CREATE TABLE t0 (c0 INT, c1 VARCHAR(50), c2 FLOAT); INSERT INTO t0 (c0, c1, c2) VALUES (1, 'Group1', -10.5), (2, 'Group1', 20.25), (3, 'Group2', 0.001), (4, 'Group2', 45000.55); SELECT c0, c1, c2, AVG(c2) OVER(PARTITION BY c1 ORDER BY c0 ROWS BETWEEN 1 PRECEDING AND CURRENT ROW) AS avg_dynamic FROM t0;